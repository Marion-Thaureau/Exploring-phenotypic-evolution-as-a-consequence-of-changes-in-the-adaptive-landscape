Starting job 9511642 on c1-1 on saga at Sat Oct 7 18:54:09 CEST 2023


Currently Loaded Modules:
  1) StdEnv                              (S)
  2) GCCcore/11.3.0
  3) zlib/1.2.12-GCCcore-11.3.0          (H)
  4) binutils/2.38-GCCcore-11.3.0        (H)
  5) GCC/11.3.0
  6) numactl/2.0.14-GCCcore-11.3.0       (H)
  7) XZ/5.2.5-GCCcore-11.3.0             (H)
  8) libxml2/2.9.13-GCCcore-11.3.0       (H)
  9) libpciaccess/0.16-GCCcore-11.3.0    (H)
 10) hwloc/2.7.1-GCCcore-11.3.0          (H)
 11) hpcx/2.14
 12) OpenMPI/4.1.4-GCC-11.3.0
 13) OpenBLAS/0.3.20-GCC-11.3.0
 14) FlexiBLAS/3.2.0-GCC-11.3.0
 15) FFTW/3.3.10-GCC-11.3.0
 16) gompi/2022a
 17) FFTW.MPI/3.3.10-gompi-2022a
 18) ScaLAPACK/2.2.0-gompi-2022a-fb
 19) foss/2022a
 20) bzip2/1.0.8-GCCcore-11.3.0          (H)
 21) expat/2.4.8-GCCcore-11.3.0          (H)
 22) libpng/1.6.37-GCCcore-11.3.0        (H)
 23) Brotli/1.0.9-GCCcore-11.3.0         (H)
 24) freetype/2.12.1-GCCcore-11.3.0      (H)
 25) ncurses/6.3-GCCcore-11.3.0          (H)
 26) util-linux/2.38-GCCcore-11.3.0      (H)
 27) fontconfig/2.14.0-GCCcore-11.3.0    (H)
 28) xorg-macros/1.19.3-GCCcore-11.3.0   (H)
 29) X11/20220504-GCCcore-11.3.0         (H)
 30) gzip/1.12-GCCcore-11.3.0            (H)
 31) lz4/1.9.3-GCCcore-11.3.0            (H)
 32) zstd/1.5.2-GCCcore-11.3.0           (H)
 33) libdrm/2.4.110-GCCcore-11.3.0       (H)
 34) libglvnd/1.4.0-GCCcore-11.3.0       (H)
 35) libunwind/1.6.2-GCCcore-11.3.0      (H)
 36) LLVM/14.0.3-GCCcore-11.3.0          (H)
 37) Mesa/22.0.3-GCCcore-11.3.0          (H)
 38) libGLU/9.0.2-GCCcore-11.3.0         (H)
 39) pixman/0.40.0-GCCcore-11.3.0        (H)
 40) libffi/3.4.2-GCCcore-11.3.0         (H)
 41) gettext/0.21-GCCcore-11.3.0         (H)
 42) PCRE/8.45-GCCcore-11.3.0            (H)
 43) GLib/2.72.1-GCCcore-11.3.0          (H)
 44) cairo/1.17.4-GCCcore-11.3.0         (H)
 45) libreadline/8.1.2-GCCcore-11.3.0    (H)
 46) Tcl/8.6.12-GCCcore-11.3.0           (H)
 47) SQLite/3.38.3-GCCcore-11.3.0        (H)
 48) PCRE2/10.40-GCCcore-11.3.0          (H)
 49) NASM/2.15.05-GCCcore-11.3.0         (H)
 50) libjpeg-turbo/2.1.3-GCCcore-11.3.0  (H)
 51) jbigkit/2.1-GCCcore-11.3.0          (H)
 52) libdeflate/1.10-GCCcore-11.3.0      (H)
 53) LibTIFF/4.3.0-GCCcore-11.3.0        (H)
 54) Java/11.0.16
 55) Tk/8.6.12-GCCcore-11.3.0            (H)
 56) OpenSSL/1.1                         (H)
 57) cURL/7.83.0-GCCcore-11.3.0          (H)
 58) GMP/6.2.1-GCCcore-11.3.0            (H)
 59) NLopt/2.7.1-GCCcore-11.3.0          (H)
 60) libogg/1.3.5-GCCcore-11.3.0         (H)
 61) FLAC/1.3.4-GCCcore-11.3.0           (H)
 62) libvorbis/1.3.7-GCCcore-11.3.0      (H)
 63) libopus/1.3.1-GCCcore-11.3.0        (H)
 64) LAME/3.100-GCCcore-11.3.0           (H)
 65) libsndfile/1.1.0-GCCcore-11.3.0     (H)
 66) ICU/71.1-GCCcore-11.3.0             (H)
 67) Szip/2.1.1-GCCcore-11.3.0           (H)
 68) HDF5/1.12.2-gompi-2022a
 69) UDUNITS/2.2.28-GCCcore-11.3.0
 70) GSL/2.7-GCC-11.3.0
 71) ATK/2.38.0-GCCcore-11.3.0           (H)
 72) Gdk-Pixbuf/2.42.8-GCCcore-11.3.0    (H)
 73) HarfBuzz/4.2.1-GCCcore-11.3.0       (H)
 74) FriBidi/1.0.12-GCCcore-11.3.0       (H)
 75) Pango/1.50.7-GCCcore-11.3.0         (H)
 76) GTK2/2.24.33-GCCcore-11.3.0         (H)
 77) Ghostscript/9.56.1-GCCcore-11.3.0   (H)
 78) JasPer/2.0.33-GCCcore-11.3.0        (H)
 79) LittleCMS/2.13.1-GCCcore-11.3.0     (H)
 80) ImageMagick/7.1.0-37-GCCcore-11.3.0 (H)
 81) GLPK/5.0-GCCcore-11.3.0             (H)
 82) nodejs/16.15.1-GCCcore-11.3.0       (H)
 83) Python/3.10.4-GCCcore-11.3.0
 84) netCDF/4.9.0-gompi-2022a
 85) GEOS/3.10.3-GCC-11.3.0
 86) nlohmann_json/3.10.5-GCCcore-11.3.0 (H)
 87) PROJ/9.0.0-GCCcore-11.3.0
 88) libgeotiff/1.7.1-GCCcore-11.3.0     (H)
 89) pybind11/2.9.2-GCCcore-11.3.0       (H)
 90) SciPy-bundle/2022.05-foss-2022a
 91) libtirpc/1.3.2-GCCcore-11.3.0       (H)
 92) HDF/4.2.15-GCCcore-11.3.0           (H)
 93) GDAL/3.5.0-foss-2022a
 94) MPFR/4.1.0-GCCcore-11.3.0           (H)
 95) libgit2/1.4.3-GCCcore-11.3.0        (H)
 96) R/4.2.1-foss-2022a

  Where:
   H:  Hidden Module
   S:  Module is Sticky, requires --force to unload or purge

 


R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###### PACKAGES AND FILE DIRECTORY ######
> 
> .libPaths("/cluster/home/marionth/R")
> library(evoTS)
Warning message:
package ‘evoTS’ was built under R version 4.2.2 
> library(paleoTS)
Warning message:
package ‘paleoTS’ was built under R version 4.2.2 
> library(stats)
> library(dplyr)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> library(parallel)
> library(foreach)
> library(doParallel)
Loading required package: iterators
> library(MCSPCD)
> 
> 
> setwd("/cluster/home/marionth/Hodell")
> getwd()
[1] "/cluster/home/marionth/Hodell"
> 
> 
> 
> 
> ###### LENGTH WITH d18O PROXY ITERATIONS ######
> 
> 
> 
> 
> data1=read.table("Hodell_and_Vayavananda_1993_Fohsella_length.txt",header=T)
> data13C <- read.csv("/cluster/home/marionth/Hodell/table_d13C.csv")
> datalength13C = cbind(data1,data13C)
> data13Cbis = datalength13C %>% filter(!is.na(Mean_isotopsd13C)) #enlever toutes les lignes contenant NA dans la colonne "Mean" pour data13C et datalength
> 
> sample_sized13C=data13Cbis[[1]]
> length_meansd13C=data13Cbis[[2]]
> length_varianced13C=data13Cbis[[3]]
> time_vectord13C=data13Cbis[[4]]
> d13C_means=data13Cbis[[5]]
> d13C_variance=data13Cbis[[6]]
> d13C_samplesize=data13Cbis[[7]]
> d13C_timevector=data13Cbis[[8]]
> 
> ln.lengthd13C=paleoTS::as.paleoTS(mm=length_meansd13C, vv=length_varianced13C, nn=sample_sized13C, tt=time_vectord13C) 
> ln.lengthd13C$tt=ln.lengthd13C$tt/(max(ln.lengthd13C$tt))
> datad13C=paleoTS::as.paleoTS(mm=d13C_means, vv=d13C_variance, nn=d13C_samplesize, tt=d13C_timevector)
> datad13C$tt=datad13C$tt/(max(datad13C$tt)) #rescale le temps
> 
> 
> multid13Ci=make.multivar.evoTS(ln.lengthd13C, datad13C) 
> plotevoTS.multivariate(multid13Ci, y_min=-3, y_max=3, x.label="relative time", y.label="Trait and proxy d13C means", pch=c(20,20))
> 
> 
> 
> 
> 
> 
> #number of cores that I want to use (also defined in the batch script)
> registerDoParallel(15)
> 
> #To calculate the time needed to process each iteration
> start_time <- Sys.time()
> 
> 
> 
> 
> ## WITH ENVIRONMENTAL FACTOR AFFECTING THE OPTIMUM OF PHENOTYPIC TRAITS FOR NUMBER OF ENVIRONMENTAL VARIABLES REDUCED (2)
> A = matrix(c(1,1,0,0), nrow = 2, byrow=TRUE) #1 for parametrised and 0 for not parametrised
> R = matrix(c(1,0,0,1), nrow = 2, byrow=TRUE) #5 traits donc 25 cases dans la matrice
> 
> 
> 
> 
> 
> #Loop foreach 
> OUOUmodel.uprowd13C <- foreach(i=1:100) %dopar% { #calculation for each iteration 
+   result <- multiResultClass() #create a table to store the results
+   
+   #set and register a different seed for each loop
+   seed <- (10+i) 
+   set.seed(seed)
+   
+   result$result1 <- seed
+   result$result2 <- fit.multivariate.OU.user.defined(multid13Ci,A.user=A,R.user=R, iterations=1)
+   
+   
+   end_time <- Sys.time(); end_time - start_time 
+   print( end_time - start_time ) 
+   result$result3 <- end_time - start_time 
+   
+   return(result)
+   
+ }
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 1.087186 hours
Time difference of 1.219043 hours
Time difference of 1.431724 hours
Time difference of 1.675866 hours
Time difference of 1.818659 hours
Time difference of 2.695258 hours
Time difference of 2.730737 hours
Time difference of 3.095932 hours
Time difference of 3.242183 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 3.473201 hours
Time difference of 3.506172 hours
Time difference of 3.717248 hours
Time difference of 3.804387 hours
Time difference of 3.914307 hours
Time difference of 4.184084 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 4.331538 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 4.730458 hours
Time difference of 4.983427 hours
Time difference of 5.006894 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 5.388743 hours
Time difference of 6.174433 hours
Time difference of 6.345312 hours
Time difference of 6.459882 hours
Time difference of 6.548748 hours
Time difference of 6.955458 hours
Time difference of 7.108609 hours
Time difference of 7.2043 hours
Time difference of 7.601009 hours
Time difference of 7.701651 hours
Time difference of 7.722732 hours
Time difference of 8.080709 hours
Time difference of 8.229361 hours
Time difference of 8.495002 hours
Time difference of 8.57987 hours
Time difference of 8.602393 hours
Time difference of 9.41001 hours
Time difference of 9.526309 hours
Time difference of 9.822599 hours
Time difference of 10.10134 hours
Time difference of 10.27638 hours
Time difference of 10.40548 hours
Time difference of 10.88291 hours
Time difference of 11.29706 hours
Time difference of 11.3765 hours
Time difference of 11.58183 hours
Time difference of 11.91874 hours
Time difference of 11.95682 hours
Time difference of 11.96748 hours
Time difference of 12.38208 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 13.33403 hours
Time difference of 13.36522 hours
Time difference of 13.49242 hours
Time difference of 13.69799 hours
Time difference of 13.86524 hours
Time difference of 13.886 hours
Time difference of 14.39539 hours
Time difference of 14.6426 hours
Time difference of 15.05072 hours
Time difference of 15.27137 hours
Time difference of 15.33631 hours
Time difference of 15.35048 hours
Time difference of 15.439 hours
Time difference of 15.56042 hours
Time difference of 15.58292 hours
Time difference of 15.94367 hours
Time difference of 16.26464 hours
Time difference of 16.34335 hours
Time difference of 16.35351 hours
Time difference of 16.44907 hours
Time difference of 16.69556 hours
Time difference of 16.71935 hours
Time difference of 17.13941 hours
Time difference of 17.22623 hours
Time difference of 17.31319 hours
Time difference of 17.4233 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 17.5372 hours
Time difference of 17.72402 hours
Time difference of 17.8623 hours
Time difference of 17.94649 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 18.47147 hours
Time difference of 18.75863 hours
Time difference of 19.00528 hours
Time difference of 19.54573 hours
Time difference of 19.61967 hours
Time difference of 19.6645 hours
Time difference of 20.44398 hours
Time difference of 20.48814 hours
Time difference of 20.50034 hours
Time difference of 20.67226 hours
Time difference of 20.70827 hours
Time difference of 20.81303 hours
Time difference of 21.47958 hours
Time difference of 21.50123 hours
Time difference of 22.16669 hours
Time difference of 22.23513 hours
Time difference of 22.26163 hours
Time difference of 23.18704 hours
Time difference of 23.68948 hours
Time difference of 1.010953 days
Time difference of 1.206243 days
> 
> 
> print ("DONE")
[1] "DONE"
> end_time <- Sys.time(); end_time - start_time
Time difference of 1.206244 days
> 
> 
> 
> 
> 
> save.image(file='Hodell_Length_d13C_4.RData')
> 
> 
> 
> 
> #creation of AIC matrix
> AICvalues<-matrix(ncol=2,nrow=100)
> colnames(AICvalues) <- c("iteration", "AIC")
> 
> 
> #Loop to fill the AIC matrix
> for (j in 1:100) {
+   AICvalues[j,1] = j #iteration number
+   AICvalues[j,2] = OUOUmodel.uprowd13C[[j]]$result2$AIC #AIC value
+ }
> 
> 
> #Finding the best AIC
> BestAICiteration = which.min(AICvalues[,2])
> 
> #Finding the best iteration associated to the best AIC
> BESTRESULT=OUOUmodel.uprowd13C[[BestAICiteration]]
> BESTRESULT
$LE_overall
NULL

$LE_overall_exp
NULL

$LE_overall_nonexp
NULL

$LE_without_dis
NULL

$LE_without_dis_exp
NULL

$LE_without_dis_nonexp
NULL

$LE_dis
NULL

$LE_dis_exp
NULL

$LE_dis_nonexp
NULL

$LE_non_dis
NULL

$LE_non_dis_exp
NULL

$LE_non_dis_nonexp
NULL

$np_age
NULL

$tp_dis
NULL

$nsurvival
NULL

$rsurvival
NULL

$nb_dis
NULL

$nb_dis_exp
NULL

$nb_dis_nonexp
NULL

$p_dis
NULL

$a_dis
NULL

$m_exp
NULL

$p_exp
NULL

$mortality_r
NULL

$result1
[1] 35

$result2
$converge
[1] "The search algorithm stopped as it did not make progress towards the optimal solution"

$logL
[1] 258.9639

$AICc
[1] -502.8297

$ancestral.values
[1] -1.497904  1.986572

$SE.anc
[1] NA

$optima
[1] -1.236973        NA

$SE.optima
[1] NA

$A
         [,1]     [,2]
[1,] 6.902138 5.117186
[2,] 0.000000 0.000000

$SE.A
[1] NA

$half.life
[1] 0.100425      Inf

$R
          [,1]      [,2]
[1,] 0.3070609 0.0000000
[2,] 0.0000000 0.8577591

$SE.R
[1] NA

$method
[1] "Joint"

$K
[1] 7

$n
[1] 110

$iter
[1] 1

attr(,"class")
[1] "paleoTSfit"

$result3
Time difference of 9.41001 hours

> 

Job 9511642 consumed 434.5 billing hours from project nn8105k.

Submitted 2023-10-07T18:52:24; waited 1.7 minutes in the queue after becoming eligible to run.

Requested wallclock time: 5.0 days
Elapsed wallclock time:   1.2 days

Task and CPU statistics:
ID             CPUs  Tasks  CPU util                Start  Elapsed  Exit status
9511642          15            0.0 %  2023-10-07T18:54:08   29.0 h  0
9511642.batch    15      1   147.0 %  2023-10-07T18:54:08   29.0 h  0

Used CPU time:   26.6 CPU days
Unused CPU time: 0.0 CPU seconds

Memory statistics, in GiB:
ID              Alloc   Usage
9511642           7.0        
9511642.batch     7.0     5.1

Job 9511642 completed at Sun Oct 8 23:52:01 CEST 2023
