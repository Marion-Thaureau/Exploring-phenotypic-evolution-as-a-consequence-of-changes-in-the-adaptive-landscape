(miss Rdata file)
Starting job 9632266 on c2-31 on saga at Wed Oct 11 17:51:53 CEST 2023


Currently Loaded Modules:
  1) StdEnv                              (S)
  2) GCCcore/11.3.0
  3) zlib/1.2.12-GCCcore-11.3.0          (H)
  4) binutils/2.38-GCCcore-11.3.0        (H)
  5) GCC/11.3.0
  6) numactl/2.0.14-GCCcore-11.3.0       (H)
  7) XZ/5.2.5-GCCcore-11.3.0             (H)
  8) libxml2/2.9.13-GCCcore-11.3.0       (H)
  9) libpciaccess/0.16-GCCcore-11.3.0    (H)
 10) hwloc/2.7.1-GCCcore-11.3.0          (H)
 11) hpcx/2.14
 12) OpenMPI/4.1.4-GCC-11.3.0
 13) OpenBLAS/0.3.20-GCC-11.3.0
 14) FlexiBLAS/3.2.0-GCC-11.3.0
 15) FFTW/3.3.10-GCC-11.3.0
 16) gompi/2022a
 17) FFTW.MPI/3.3.10-gompi-2022a
 18) ScaLAPACK/2.2.0-gompi-2022a-fb
 19) foss/2022a
 20) bzip2/1.0.8-GCCcore-11.3.0          (H)
 21) expat/2.4.8-GCCcore-11.3.0          (H)
 22) libpng/1.6.37-GCCcore-11.3.0        (H)
 23) Brotli/1.0.9-GCCcore-11.3.0         (H)
 24) freetype/2.12.1-GCCcore-11.3.0      (H)
 25) ncurses/6.3-GCCcore-11.3.0          (H)
 26) util-linux/2.38-GCCcore-11.3.0      (H)
 27) fontconfig/2.14.0-GCCcore-11.3.0    (H)
 28) xorg-macros/1.19.3-GCCcore-11.3.0   (H)
 29) X11/20220504-GCCcore-11.3.0         (H)
 30) gzip/1.12-GCCcore-11.3.0            (H)
 31) lz4/1.9.3-GCCcore-11.3.0            (H)
 32) zstd/1.5.2-GCCcore-11.3.0           (H)
 33) libdrm/2.4.110-GCCcore-11.3.0       (H)
 34) libglvnd/1.4.0-GCCcore-11.3.0       (H)
 35) libunwind/1.6.2-GCCcore-11.3.0      (H)
 36) LLVM/14.0.3-GCCcore-11.3.0          (H)
 37) Mesa/22.0.3-GCCcore-11.3.0          (H)
 38) libGLU/9.0.2-GCCcore-11.3.0         (H)
 39) pixman/0.40.0-GCCcore-11.3.0        (H)
 40) libffi/3.4.2-GCCcore-11.3.0         (H)
 41) gettext/0.21-GCCcore-11.3.0         (H)
 42) PCRE/8.45-GCCcore-11.3.0            (H)
 43) GLib/2.72.1-GCCcore-11.3.0          (H)
 44) cairo/1.17.4-GCCcore-11.3.0         (H)
 45) libreadline/8.1.2-GCCcore-11.3.0    (H)
 46) Tcl/8.6.12-GCCcore-11.3.0           (H)
 47) SQLite/3.38.3-GCCcore-11.3.0        (H)
 48) PCRE2/10.40-GCCcore-11.3.0          (H)
 49) NASM/2.15.05-GCCcore-11.3.0         (H)
 50) libjpeg-turbo/2.1.3-GCCcore-11.3.0  (H)
 51) jbigkit/2.1-GCCcore-11.3.0          (H)
 52) libdeflate/1.10-GCCcore-11.3.0      (H)
 53) LibTIFF/4.3.0-GCCcore-11.3.0        (H)
 54) Java/11.0.16
 55) Tk/8.6.12-GCCcore-11.3.0            (H)
 56) OpenSSL/1.1                         (H)
 57) cURL/7.83.0-GCCcore-11.3.0          (H)
 58) GMP/6.2.1-GCCcore-11.3.0            (H)
 59) NLopt/2.7.1-GCCcore-11.3.0          (H)
 60) libogg/1.3.5-GCCcore-11.3.0         (H)
 61) FLAC/1.3.4-GCCcore-11.3.0           (H)
 62) libvorbis/1.3.7-GCCcore-11.3.0      (H)
 63) libopus/1.3.1-GCCcore-11.3.0        (H)
 64) LAME/3.100-GCCcore-11.3.0           (H)
 65) libsndfile/1.1.0-GCCcore-11.3.0     (H)
 66) ICU/71.1-GCCcore-11.3.0             (H)
 67) Szip/2.1.1-GCCcore-11.3.0           (H)
 68) HDF5/1.12.2-gompi-2022a
 69) UDUNITS/2.2.28-GCCcore-11.3.0
 70) GSL/2.7-GCC-11.3.0
 71) ATK/2.38.0-GCCcore-11.3.0           (H)
 72) Gdk-Pixbuf/2.42.8-GCCcore-11.3.0    (H)
 73) HarfBuzz/4.2.1-GCCcore-11.3.0       (H)
 74) FriBidi/1.0.12-GCCcore-11.3.0       (H)
 75) Pango/1.50.7-GCCcore-11.3.0         (H)
 76) GTK2/2.24.33-GCCcore-11.3.0         (H)
 77) Ghostscript/9.56.1-GCCcore-11.3.0   (H)
 78) JasPer/2.0.33-GCCcore-11.3.0        (H)
 79) LittleCMS/2.13.1-GCCcore-11.3.0     (H)
 80) ImageMagick/7.1.0-37-GCCcore-11.3.0 (H)
 81) GLPK/5.0-GCCcore-11.3.0             (H)
 82) nodejs/16.15.1-GCCcore-11.3.0       (H)
 83) Python/3.10.4-GCCcore-11.3.0
 84) netCDF/4.9.0-gompi-2022a
 85) GEOS/3.10.3-GCC-11.3.0
 86) nlohmann_json/3.10.5-GCCcore-11.3.0 (H)
 87) PROJ/9.0.0-GCCcore-11.3.0
 88) libgeotiff/1.7.1-GCCcore-11.3.0     (H)
 89) pybind11/2.9.2-GCCcore-11.3.0       (H)
 90) SciPy-bundle/2022.05-foss-2022a
 91) libtirpc/1.3.2-GCCcore-11.3.0       (H)
 92) HDF/4.2.15-GCCcore-11.3.0           (H)
 93) GDAL/3.5.0-foss-2022a
 94) MPFR/4.1.0-GCCcore-11.3.0           (H)
 95) libgit2/1.4.3-GCCcore-11.3.0        (H)
 96) R/4.2.1-foss-2022a

  Where:
   H:  Hidden Module
   S:  Module is Sticky, requires --force to unload or purge

 


R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###### PACKAGES AND FILE DIRECTORY ######
> 
> .libPaths("/cluster/home/marionth/R")
> library(evoTS)
Warning message:
package ‘evoTS’ was built under R version 4.2.2 
> library(paleoTS)
Warning message:
package ‘paleoTS’ was built under R version 4.2.2 
> library(stats)
> library(dplyr)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> library(parallel)
> library(foreach)
> library(doParallel)
Loading required package: iterators
> library(MCSPCD)
> 
> 
> setwd("/cluster/home/marionth/Hodell")
> getwd()
[1] "/cluster/home/marionth/Hodell"
> 
> 
> 
> 
> ###### LENGTH WITH d18O PROXY ITERATIONS ######
> 
> 
> 
> 
> data1=read.table("Hodell_and_Vayavananda_1993_Fohsella_length.txt",header=T)
> data13C <- read.csv("/cluster/home/marionth/Hodell/table_d13C.csv")
> datalength13C = cbind(data1,data13C)
> data13Cbis = datalength13C %>% filter(!is.na(Mean_isotopsd13C)) #enlever toutes les lignes contenant NA dans la colonne "Mean" pour data13C et datalength
> 
> 
> d13C_means=data13Cbis[[5]]
> d13C_variance=data13Cbis[[6]]
> d13C_samplesize=data13Cbis[[7]]
> d13C_timevector=data13Cbis[[8]]
> 
> 
> datad13C=paleoTS::as.paleoTS(mm=d13C_means, vv=d13C_variance, nn=d13C_samplesize, tt=d13C_timevector)
> datad13C$tt=datad13C$tt/(max(datad13C$tt)) #rescale le temps
> 
> 
> 
> 
> 
> 
> data18O <- read.csv("/cluster/home/marionth/Hodell/table_d18O.csv")
> datalength18O = cbind(data1,data18O)
> data18Obis = datalength18O %>% filter(!is.na(Mean_isotopsd18O)) #enlever toutes les lignes contenant NA dans la colonne "Mean" pour data13C et datalength
> 
> 
> d18O_means=data18Obis[[5]]
> d18O_variance=data18Obis[[6]]
> d18O_samplesize=data18Obis[[7]]
> d18O_timevector=data18Obis[[8]]
> 
> 
> datad18Oi=paleoTS::as.paleoTS(mm=d18O_means, vv=d18O_variance, nn=d18O_samplesize, tt=d18O_timevector) #create two paleoTS object
> datad18Oi$tt=datad18Oi$tt/(max(datad18Oi$tt))  #rescale du temps   
> 
> 
> multiENVI=make.multivar.evoTS(datad18Oi, datad13C) 
> plotevoTS.multivariate(multiENVI, y_min=-3, y_max=3, x.label="relative time", y.label="Trait and proxy d13C means", pch=c(20,20))
>  
> 
> 
> 
> 
> 
> 
> 
> #number of cores that I want to use (also defined in the batch script)
> registerDoParallel(15)
> 
> #To calculate the time needed to process each iteration
> start_time <- Sys.time()
> 
> 
> 
> 
> A = matrix(c(0,1,0,1), nrow = 2, byrow=TRUE) #1 for parametrised and 0 for not parametrised
> R = matrix(c(1,0,0,1), nrow = 2, byrow=TRUE) #5 traits donc 25 cases dans la matrice
> 
> 
> 
> 
> 
> #Loop foreach 
> OUOUmodel.fullrowenvi <- foreach(i=1:100) %dopar% { #calculation for each iteration 
+   result <- multiResultClass() #create a table to store the results
+   
+   #set and register a different seed for each loop
+   seed <- (10+i) 
+   set.seed(seed)
+   
+   result$result1 <- seed
+   result$result2 <- fit.multivariate.OU.user.defined(multiENVI,A.user=A,R.user=R, iterations=1)
+   
+   
+   end_time <- Sys.time(); end_time - start_time 
+   print( end_time - start_time ) 
+   result$result3 <- end_time - start_time 
+   
+   return(result)
+   
+ }
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 1.885551 hours
Time difference of 2.739264 hours
Time difference of 2.753018 hours
Time difference of 3.172749 hours
Time difference of 3.24587 hours
Time difference of 3.302907 hours
Time difference of 3.433296 hours
Time difference of 3.48183 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 3.611854 hours
Time difference of 3.771861 hours
Time difference of 3.785738 hours
Time difference of 3.822954 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 3.852008 hours
Time difference of 4.425902 hours
Time difference of 5.172124 hours
Time difference of 5.204739 hours
Time difference of 5.527819 hours
Time difference of 5.579759 hours
Time difference of 5.79601 hours
Time difference of 6.388546 hours
Time difference of 6.401528 hours
Time difference of 6.739869 hours
Time difference of 6.869742 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 7.509876 hours
Time difference of 7.74542 hours
Time difference of 8.01479 hours
Time difference of 8.101181 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 8.770317 hours
Time difference of 8.912206 hours
Time difference of 9.099783 hours
Time difference of 9.124883 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 9.429411 hours
Time difference of 9.617936 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 9.801057 hours
Time difference of 9.893842 hours
Time difference of 10.00554 hours
Time difference of 10.60532 hours
Time difference of 10.92205 hours
Time difference of 11.20208 hours
Time difference of 11.3192 hours
Time difference of 11.48772 hours
Time difference of 11.54055 hours
Time difference of 11.62927 hours
Time difference of 11.76848 hours
Time difference of 12.01581 hours
Time difference of 12.40609 hours
Time difference of 12.43775 hours
Time difference of 12.48196 hours
Time difference of 13.11961 hours
Time difference of 13.36423 hours
Time difference of 13.46354 hours
Time difference of 13.5065 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 14.04661 hours
Time difference of 14.50244 hours
Time difference of 14.53348 hours
Time difference of 14.58959 hours
Time difference of 15.04447 hours
Time difference of 15.51255 hours
Time difference of 15.54315 hours
Time difference of 15.56352 hours
Time difference of 15.89222 hours
Time difference of 15.94301 hours
Time difference of 16.16943 hours
Time difference of 16.43248 hours
Time difference of 16.49578 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 17.14086 hours
Time difference of 17.19391 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 17.56795 hours
Time difference of 17.79963 hours
Time difference of 17.81343 hours
Time difference of 17.99165 hours
Time difference of 18.13821 hours
Time difference of 18.26771 hours
Time difference of 18.4088 hours
Time difference of 18.45973 hours
Time difference of 18.73865 hours
Time difference of 19.14262 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 19.87721 hours
Time difference of 20.21759 hours
Time difference of 20.47297 hours
Time difference of 20.68835 hours
Time difference of 20.78154 hours
Time difference of 21.03624 hours
Time difference of 21.10249 hours
Time difference of 21.1461 hours
Time difference of 21.39615 hours
Time difference of 21.39692 hours
Time difference of 21.4313 hours
Time difference of 21.71493 hours
Time difference of 21.93519 hours
Time difference of 22.01877 hours
Time difference of 22.36687 hours
Time difference of 22.48529 hours
Time difference of 22.7407 hours
Time difference of 22.88886 hours
Time difference of 22.97029 hours
Time difference of 22.9945 hours
Time difference of 23.10949 hours
Time difference of 23.44809 hours
Time difference of 1.051182 days
> 
> 
> print ("DONE")
[1] "DONE"
> end_time <- Sys.time(); end_time - start_time
Time difference of 1.051183 days
> 
> 
> #creation of AIC matrix
> AICvalues<-matrix(ncol=2,nrow=100)
> colnames(AICvalues) <- c("iteration", "AIC")
> 
> 
> #Loop to fill the AIC matrix
> for (j in 1:100) {
+   AICvalues[j,1] = j #iteration number
+   AICvalues[j,2] = OUOUmodel.fullrowenvi[[j]]$result2$AIC #AIC value
+ }
> 
> 
> #Finding the best AIC
> BestAICiteration = which.min(AICvalues[,2])
> 
> #Finding the best iteration associated to the best AIC
> BESTRESULT=OUOUmodel.fullrowenvi[[BestAICiteration]]
> BESTRESULT
$LE_overall
NULL

$LE_overall_exp
NULL

$LE_overall_nonexp
NULL

$LE_without_dis
NULL

$LE_without_dis_exp
NULL

$LE_without_dis_nonexp
NULL

$LE_dis
NULL

$LE_dis_exp
NULL

$LE_dis_nonexp
NULL

$LE_non_dis
NULL

$LE_non_dis_exp
NULL

$LE_non_dis_nonexp
NULL

$np_age
NULL

$tp_dis
NULL

$nsurvival
NULL

$rsurvival
NULL

$nb_dis
NULL

$nb_dis_exp
NULL

$nb_dis_nonexp
NULL

$p_dis
NULL

$a_dis
NULL

$m_exp
NULL

$p_exp
NULL

$mortality_r
NULL

$result1
[1] 42

$result2
$converge
[1] "Model converged successfully"

$logL
[1] 206.8779

$AICc
[1] -398.6577

$ancestral.values
[1] -1.181609  2.111648

$SE.anc
[1] NA

$optima
[1]       NA 1.687989

$SE.optima
[1] NA

$A
     [,1]      [,2]
[1,]    0 -5.087039
[2,]    0 10.265875

$SE.A
[1] NA

$half.life
[1]        Inf 0.06751954

$R
          [,1]     [,2]
[1,] 0.1904117 0.000000
[2,] 0.0000000 0.845074

$SE.R
[1] NA

$method
[1] "Joint"

$K
[1] 7

$n
[1] 110

$iter
[1] 1

attr(,"class")
[1] "paleoTSfit"

$result3
Time difference of 13.5065 hours

> 
> 
> 
> save.image(file='Hodell_d18O_d13C_8.RData')
> 

Job 9632266 consumed 378.7 billing hours from project nn8105k.

Submitted 2023-10-11T17:51:53; waited 0.0 seconds in the queue after becoming eligible to run.

Requested wallclock time: 5.0 days
Elapsed wallclock time:   1.1 days

Task and CPU statistics:
ID             CPUs  Tasks  CPU util                Start  Elapsed  Exit status
9632266          15            0.0 %  2023-10-11T17:51:53   25.2 h  0
9632266.batch    15      1   179.6 %  2023-10-11T17:51:53   25.2 h  0

Used CPU time:   28.3 CPU days
Unused CPU time: 0.0 CPU seconds

Memory statistics, in GiB:
ID              Alloc   Usage
9632266          10.0        
9632266.batch    10.0     5.8

Job 9632266 completed at Thu Oct 12 19:06:38 CEST 2023
