Starting job 9511639 on c1-44 on saga at Sat Oct 7 18:54:09 CEST 2023


Currently Loaded Modules:
  1) StdEnv                              (S)
  2) GCCcore/11.3.0
  3) zlib/1.2.12-GCCcore-11.3.0          (H)
  4) binutils/2.38-GCCcore-11.3.0        (H)
  5) GCC/11.3.0
  6) numactl/2.0.14-GCCcore-11.3.0       (H)
  7) XZ/5.2.5-GCCcore-11.3.0             (H)
  8) libxml2/2.9.13-GCCcore-11.3.0       (H)
  9) libpciaccess/0.16-GCCcore-11.3.0    (H)
 10) hwloc/2.7.1-GCCcore-11.3.0          (H)
 11) hpcx/2.14
 12) OpenMPI/4.1.4-GCC-11.3.0
 13) OpenBLAS/0.3.20-GCC-11.3.0
 14) FlexiBLAS/3.2.0-GCC-11.3.0
 15) FFTW/3.3.10-GCC-11.3.0
 16) gompi/2022a
 17) FFTW.MPI/3.3.10-gompi-2022a
 18) ScaLAPACK/2.2.0-gompi-2022a-fb
 19) foss/2022a
 20) bzip2/1.0.8-GCCcore-11.3.0          (H)
 21) expat/2.4.8-GCCcore-11.3.0          (H)
 22) libpng/1.6.37-GCCcore-11.3.0        (H)
 23) Brotli/1.0.9-GCCcore-11.3.0         (H)
 24) freetype/2.12.1-GCCcore-11.3.0      (H)
 25) ncurses/6.3-GCCcore-11.3.0          (H)
 26) util-linux/2.38-GCCcore-11.3.0      (H)
 27) fontconfig/2.14.0-GCCcore-11.3.0    (H)
 28) xorg-macros/1.19.3-GCCcore-11.3.0   (H)
 29) X11/20220504-GCCcore-11.3.0         (H)
 30) gzip/1.12-GCCcore-11.3.0            (H)
 31) lz4/1.9.3-GCCcore-11.3.0            (H)
 32) zstd/1.5.2-GCCcore-11.3.0           (H)
 33) libdrm/2.4.110-GCCcore-11.3.0       (H)
 34) libglvnd/1.4.0-GCCcore-11.3.0       (H)
 35) libunwind/1.6.2-GCCcore-11.3.0      (H)
 36) LLVM/14.0.3-GCCcore-11.3.0          (H)
 37) Mesa/22.0.3-GCCcore-11.3.0          (H)
 38) libGLU/9.0.2-GCCcore-11.3.0         (H)
 39) pixman/0.40.0-GCCcore-11.3.0        (H)
 40) libffi/3.4.2-GCCcore-11.3.0         (H)
 41) gettext/0.21-GCCcore-11.3.0         (H)
 42) PCRE/8.45-GCCcore-11.3.0            (H)
 43) GLib/2.72.1-GCCcore-11.3.0          (H)
 44) cairo/1.17.4-GCCcore-11.3.0         (H)
 45) libreadline/8.1.2-GCCcore-11.3.0    (H)
 46) Tcl/8.6.12-GCCcore-11.3.0           (H)
 47) SQLite/3.38.3-GCCcore-11.3.0        (H)
 48) PCRE2/10.40-GCCcore-11.3.0          (H)
 49) NASM/2.15.05-GCCcore-11.3.0         (H)
 50) libjpeg-turbo/2.1.3-GCCcore-11.3.0  (H)
 51) jbigkit/2.1-GCCcore-11.3.0          (H)
 52) libdeflate/1.10-GCCcore-11.3.0      (H)
 53) LibTIFF/4.3.0-GCCcore-11.3.0        (H)
 54) Java/11.0.16
 55) Tk/8.6.12-GCCcore-11.3.0            (H)
 56) OpenSSL/1.1                         (H)
 57) cURL/7.83.0-GCCcore-11.3.0          (H)
 58) GMP/6.2.1-GCCcore-11.3.0            (H)
 59) NLopt/2.7.1-GCCcore-11.3.0          (H)
 60) libogg/1.3.5-GCCcore-11.3.0         (H)
 61) FLAC/1.3.4-GCCcore-11.3.0           (H)
 62) libvorbis/1.3.7-GCCcore-11.3.0      (H)
 63) libopus/1.3.1-GCCcore-11.3.0        (H)
 64) LAME/3.100-GCCcore-11.3.0           (H)
 65) libsndfile/1.1.0-GCCcore-11.3.0     (H)
 66) ICU/71.1-GCCcore-11.3.0             (H)
 67) Szip/2.1.1-GCCcore-11.3.0           (H)
 68) HDF5/1.12.2-gompi-2022a
 69) UDUNITS/2.2.28-GCCcore-11.3.0
 70) GSL/2.7-GCC-11.3.0
 71) ATK/2.38.0-GCCcore-11.3.0           (H)
 72) Gdk-Pixbuf/2.42.8-GCCcore-11.3.0    (H)
 73) HarfBuzz/4.2.1-GCCcore-11.3.0       (H)
 74) FriBidi/1.0.12-GCCcore-11.3.0       (H)
 75) Pango/1.50.7-GCCcore-11.3.0         (H)
 76) GTK2/2.24.33-GCCcore-11.3.0         (H)
 77) Ghostscript/9.56.1-GCCcore-11.3.0   (H)
 78) JasPer/2.0.33-GCCcore-11.3.0        (H)
 79) LittleCMS/2.13.1-GCCcore-11.3.0     (H)
 80) ImageMagick/7.1.0-37-GCCcore-11.3.0 (H)
 81) GLPK/5.0-GCCcore-11.3.0             (H)
 82) nodejs/16.15.1-GCCcore-11.3.0       (H)
 83) Python/3.10.4-GCCcore-11.3.0
 84) netCDF/4.9.0-gompi-2022a
 85) GEOS/3.10.3-GCC-11.3.0
 86) nlohmann_json/3.10.5-GCCcore-11.3.0 (H)
 87) PROJ/9.0.0-GCCcore-11.3.0
 88) libgeotiff/1.7.1-GCCcore-11.3.0     (H)
 89) pybind11/2.9.2-GCCcore-11.3.0       (H)
 90) SciPy-bundle/2022.05-foss-2022a
 91) libtirpc/1.3.2-GCCcore-11.3.0       (H)
 92) HDF/4.2.15-GCCcore-11.3.0           (H)
 93) GDAL/3.5.0-foss-2022a
 94) MPFR/4.1.0-GCCcore-11.3.0           (H)
 95) libgit2/1.4.3-GCCcore-11.3.0        (H)
 96) R/4.2.1-foss-2022a

  Where:
   H:  Hidden Module
   S:  Module is Sticky, requires --force to unload or purge

 


R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###### PACKAGES AND FILE DIRECTORY ######
> 
> .libPaths("/cluster/home/marionth/R")
> library(evoTS)
Warning message:
package ‘evoTS’ was built under R version 4.2.2 
> library(paleoTS)
Warning message:
package ‘paleoTS’ was built under R version 4.2.2 
> library(stats)
> library(dplyr)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> library(parallel)
> library(foreach)
> library(doParallel)
Loading required package: iterators
> library(MCSPCD)
> 
> 
> setwd("/cluster/home/marionth/Hodell")
> getwd()
[1] "/cluster/home/marionth/Hodell"
> 
> 
> 
> 
> ###### LENGTH WITH d18O PROXY ITERATIONS ######
> 
> 
> 
> 
> data1=read.table("Hodell_and_Vayavananda_1993_Fohsella_length.txt",header=T)
> data13C <- read.csv("/cluster/home/marionth/Hodell/table_d13C.csv")
> datalength13C = cbind(data1,data13C)
> data13Cbis = datalength13C %>% filter(!is.na(Mean_isotopsd13C)) #enlever toutes les lignes contenant NA dans la colonne "Mean" pour data13C et datalength
> 
> 
> d13C_means=data13Cbis[[5]]
> d13C_variance=data13Cbis[[6]]
> d13C_samplesize=data13Cbis[[7]]
> d13C_timevector=data13Cbis[[8]]
> 
> 
> datad13C=paleoTS::as.paleoTS(mm=d13C_means, vv=d13C_variance, nn=d13C_samplesize, tt=d13C_timevector)
> datad13C$tt=datad13C$tt/(max(datad13C$tt)) #rescale le temps
> 
> 
> 
> 
> 
> 
> data18O <- read.csv("/cluster/home/marionth/Hodell/table_d18O.csv")
> datalength18O = cbind(data1,data18O)
> data18Obis = datalength18O %>% filter(!is.na(Mean_isotopsd18O)) #enlever toutes les lignes contenant NA dans la colonne "Mean" pour data13C et datalength
> 
> 
> d18O_means=data18Obis[[5]]
> d18O_variance=data18Obis[[6]]
> d18O_samplesize=data18Obis[[7]]
> d18O_timevector=data18Obis[[8]]
> 
> 
> datad18Oi=paleoTS::as.paleoTS(mm=d18O_means, vv=d18O_variance, nn=d18O_samplesize, tt=d18O_timevector) #create two paleoTS object
> datad18Oi$tt=datad18Oi$tt/(max(datad18Oi$tt))  #rescale du temps   
> 
> 
> multiENVI=make.multivar.evoTS(datad18Oi, datad13C) 
> plotevoTS.multivariate(multiENVI, y_min=-3, y_max=3, x.label="relative time", y.label="Trait and proxy d13C means", pch=c(20,20))
>  
> 
> 
> 
> 
> 
> 
> 
> #number of cores that I want to use (also defined in the batch script)
> registerDoParallel(15)
> 
> #To calculate the time needed to process each iteration
> start_time <- Sys.time()
> 
> 
> 
> 
> A = matrix(c(1,1,1,1), nrow = 2, byrow=TRUE) #1 for parametrised and 0 for not parametrised
> R = matrix(c(1,0,0,1), nrow = 2, byrow=TRUE) #5 traits donc 25 cases dans la matrice
> 
> 
> 
> 
> 
> #Loop foreach 
> OUOUmodel.fullrowenvi <- foreach(i=1:100) %dopar% { #calculation for each iteration 
+   result <- multiResultClass() #create a table to store the results
+   
+   #set and register a different seed for each loop
+   seed <- (10+i) 
+   set.seed(seed)
+   
+   result$result1 <- seed
+   result$result2 <- fit.multivariate.OU.user.defined(multiENVI,A.user=A,R.user=R, iterations=1)
+   
+   
+   end_time <- Sys.time(); end_time - start_time 
+   print( end_time - start_time ) 
+   result$result3 <- end_time - start_time 
+   
+   return(result)
+   
+ }
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 1.561412 hours
Time difference of 2.32955 hours
Time difference of 3.080948 hours
Time difference of 3.329863 hours
Time difference of 3.480153 hours
Time difference of 3.582869 hours
Time difference of 4.072666 hours
Time difference of 4.330981 hours
Time difference of 4.799246 hours
Time difference of 5.172503 hours
Time difference of 5.316068 hours
Time difference of 5.959894 hours
Time difference of 6.03153 hours
Time difference of 7.206233 hours
Time difference of 7.333841 hours
Time difference of 7.670528 hours
Time difference of 8.101891 hours
Time difference of 8.651346 hours
Time difference of 8.948783 hours
Time difference of 9.026831 hours
Time difference of 9.308246 hours
Time difference of 9.39417 hours
Time difference of 9.899129 hours
Time difference of 10.27069 hours
Time difference of 11.02035 hours
Time difference of 11.21285 hours
Time difference of 11.63266 hours
Time difference of 11.87792 hours
Time difference of 12.21426 hours
Time difference of 12.2804 hours
Time difference of 12.49827 hours
Time difference of 12.70456 hours
Time difference of 13.13833 hours
Time difference of 13.28943 hours
Time difference of 13.69533 hours
Time difference of 13.93887 hours
Time difference of 13.94814 hours
Time difference of 14.10779 hours
Time difference of 14.86722 hours
Time difference of 14.99778 hours
Time difference of 15.63845 hours
Time difference of 15.93713 hours
Time difference of 16.71287 hours
Time difference of 17.14363 hours
Time difference of 18.32416 hours
Time difference of 18.47585 hours
Time difference of 18.71503 hours
Time difference of 18.83245 hours
Time difference of 19.32125 hours
Time difference of 19.83015 hours
Time difference of 20.09128 hours
Time difference of 20.09637 hours
Time difference of 20.81955 hours
Time difference of 21.10012 hours
Time difference of 21.14123 hours
Time difference of 21.24636 hours
Time difference of 21.33379 hours
Time difference of 21.43015 hours
Time difference of 22.03859 hours
Time difference of 22.42651 hours
Time difference of 23.10152 hours
Time difference of 23.70404 hours
Time difference of 23.71368 hours
Time difference of 23.7545 hours
Time difference of 23.77282 hours
Time difference of 1.020952 days
Time difference of 1.042938 days
Time difference of 1.046224 days
Time difference of 1.101026 days
Time difference of 1.102019 days
Time difference of 1.103718 days
Time difference of 1.106134 days
Time difference of 1.114589 days
Time difference of 1.123329 days
Time difference of 1.126703 days
Time difference of 1.183373 days
Time difference of 1.202858 days
Time difference of 1.210397 days
Time difference of 1.212322 days
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 1.219364 days
Time difference of 1.221976 days
Time difference of 1.222139 days
Time difference of 1.260111 days
Time difference of 1.260834 days
Time difference of 1.268775 days
Time difference of 1.270507 days
Time difference of 1.273787 days
Time difference of 1.286599 days
Time difference of 1.311115 days
Time difference of 1.316522 days
Time difference of 1.319018 days
Time difference of 1.320039 days
Time difference of 1.348175 days
Time difference of 1.348867 days
Time difference of 1.375987 days
Time difference of 1.392992 days
Time difference of 1.427945 days
Time difference of 1.486044 days
Time difference of 1.535117 days
Time difference of 1.5477 days
> 
> 
> print ("DONE")
[1] "DONE"
> end_time <- Sys.time(); end_time - start_time
Time difference of 1.547701 days
> 
> 
> #creation of AIC matrix
> AICvalues<-matrix(ncol=2,nrow=100)
> colnames(AICvalues) <- c("iteration", "AIC")
> 
> 
> #Loop to fill the AIC matrix
> for (j in 1:100) {
+   AICvalues[j,1] = j #iteration number
+   AICvalues[j,2] = OUOUmodel.fullrowenvi[[j]]$result2$AIC #AIC value
+ }
> 
> 
> #Finding the best AIC
> BestAICiteration = which.min(AICvalues[,2])
> 
> #Finding the best iteration associated to the best AIC
> BESTRESULT=OUOUmodel.fullrowenvi[[BestAICiteration]]
> BESTRESULT
$LE_overall
NULL

$LE_overall_exp
NULL

$LE_overall_nonexp
NULL

$LE_without_dis
NULL

$LE_without_dis_exp
NULL

$LE_without_dis_nonexp
NULL

$LE_dis
NULL

$LE_dis_exp
NULL

$LE_dis_nonexp
NULL

$LE_non_dis
NULL

$LE_non_dis_exp
NULL

$LE_non_dis_nonexp
NULL

$np_age
NULL

$tp_dis
NULL

$nsurvival
NULL

$rsurvival
NULL

$nb_dis
NULL

$nb_dis_exp
NULL

$nb_dis_nonexp
NULL

$p_dis
NULL

$a_dis
NULL

$m_exp
NULL

$p_exp
NULL

$mortality_r
NULL

$result1
[1] 102

$result2
$converge
[1] "The search algorithm stopped as it did not make progress towards the optimal solution"

$logL
[1] 207.5205

$AICc
[1] -392.8188

$ancestral.values
[1] -1.037848  2.072005

$SE.anc
[1] NA

$optima
[1] -0.511424  1.676631

$SE.optima
[1] NA

$A
         [,1]      [,2]
[1,] 1.204176  7.894534
[2,] 1.247890 16.098141

$SE.A
[1] NA

$half.life
[1] 0.57561945 0.04305759

$R
          [,1]      [,2]
[1,] 0.1673484 0.0000000
[2,] 0.0000000 0.9315433

$SE.R
[1] NA

$method
[1] "Joint"

$K
[1] 10

$n
[1] 110

$iter
[1] 1

attr(,"class")
[1] "paleoTSfit"

$result3
Time difference of 1.319018 days

> 
> 
> 
> save.image(file='Hodell_d18O_d13C_7.RData')
> 

Job 9511639 consumed 557.4 billing hours from project nn8105k.

Submitted 2023-10-07T18:52:23; waited 1.8 minutes in the queue after becoming eligible to run.

Requested wallclock time: 5.0 days
Elapsed wallclock time:   1.5 days

Task and CPU statistics:
ID             CPUs  Tasks  CPU util                Start  Elapsed  Exit status
9511639          15            0.0 %  2023-10-07T18:54:08   37.2 h  0
9511639.batch    15      1   169.6 %  2023-10-07T18:54:08   37.2 h  0

Used CPU time:   39.4 CPU days
Unused CPU time: 0.0 CPU seconds

Memory statistics, in GiB:
ID              Alloc   Usage
9511639           7.0        
9511639.batch     7.0     5.0

Job 9511639 completed at Mon Oct 9 08:03:43 CEST 2023
