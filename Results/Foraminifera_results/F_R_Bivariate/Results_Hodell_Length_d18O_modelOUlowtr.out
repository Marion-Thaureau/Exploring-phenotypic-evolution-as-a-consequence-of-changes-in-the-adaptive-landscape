Starting job 9785627 on c5-6 on saga at Tue Oct 24 09:30:13 CEST 2023


Currently Loaded Modules:
  1) StdEnv                              (S)
  2) GCCcore/11.3.0
  3) zlib/1.2.12-GCCcore-11.3.0          (H)
  4) binutils/2.38-GCCcore-11.3.0        (H)
  5) GCC/11.3.0
  6) numactl/2.0.14-GCCcore-11.3.0       (H)
  7) XZ/5.2.5-GCCcore-11.3.0             (H)
  8) libxml2/2.9.13-GCCcore-11.3.0       (H)
  9) libpciaccess/0.16-GCCcore-11.3.0    (H)
 10) hwloc/2.7.1-GCCcore-11.3.0          (H)
 11) hpcx/2.14
 12) OpenMPI/4.1.4-GCC-11.3.0
 13) OpenBLAS/0.3.20-GCC-11.3.0
 14) FlexiBLAS/3.2.0-GCC-11.3.0
 15) FFTW/3.3.10-GCC-11.3.0
 16) gompi/2022a
 17) FFTW.MPI/3.3.10-gompi-2022a
 18) ScaLAPACK/2.2.0-gompi-2022a-fb
 19) foss/2022a
 20) bzip2/1.0.8-GCCcore-11.3.0          (H)
 21) expat/2.4.8-GCCcore-11.3.0          (H)
 22) libpng/1.6.37-GCCcore-11.3.0        (H)
 23) Brotli/1.0.9-GCCcore-11.3.0         (H)
 24) freetype/2.12.1-GCCcore-11.3.0      (H)
 25) ncurses/6.3-GCCcore-11.3.0          (H)
 26) util-linux/2.38-GCCcore-11.3.0      (H)
 27) fontconfig/2.14.0-GCCcore-11.3.0    (H)
 28) xorg-macros/1.19.3-GCCcore-11.3.0   (H)
 29) X11/20220504-GCCcore-11.3.0         (H)
 30) gzip/1.12-GCCcore-11.3.0            (H)
 31) lz4/1.9.3-GCCcore-11.3.0            (H)
 32) zstd/1.5.2-GCCcore-11.3.0           (H)
 33) libdrm/2.4.110-GCCcore-11.3.0       (H)
 34) libglvnd/1.4.0-GCCcore-11.3.0       (H)
 35) libunwind/1.6.2-GCCcore-11.3.0      (H)
 36) LLVM/14.0.3-GCCcore-11.3.0          (H)
 37) Mesa/22.0.3-GCCcore-11.3.0          (H)
 38) libGLU/9.0.2-GCCcore-11.3.0         (H)
 39) pixman/0.40.0-GCCcore-11.3.0        (H)
 40) libffi/3.4.2-GCCcore-11.3.0         (H)
 41) gettext/0.21-GCCcore-11.3.0         (H)
 42) PCRE/8.45-GCCcore-11.3.0            (H)
 43) GLib/2.72.1-GCCcore-11.3.0          (H)
 44) cairo/1.17.4-GCCcore-11.3.0         (H)
 45) libreadline/8.1.2-GCCcore-11.3.0    (H)
 46) Tcl/8.6.12-GCCcore-11.3.0           (H)
 47) SQLite/3.38.3-GCCcore-11.3.0        (H)
 48) PCRE2/10.40-GCCcore-11.3.0          (H)
 49) NASM/2.15.05-GCCcore-11.3.0         (H)
 50) libjpeg-turbo/2.1.3-GCCcore-11.3.0  (H)
 51) jbigkit/2.1-GCCcore-11.3.0          (H)
 52) libdeflate/1.10-GCCcore-11.3.0      (H)
 53) LibTIFF/4.3.0-GCCcore-11.3.0        (H)
 54) Java/11.0.16
 55) Tk/8.6.12-GCCcore-11.3.0            (H)
 56) OpenSSL/1.1                         (H)
 57) cURL/7.83.0-GCCcore-11.3.0          (H)
 58) GMP/6.2.1-GCCcore-11.3.0            (H)
 59) NLopt/2.7.1-GCCcore-11.3.0          (H)
 60) libogg/1.3.5-GCCcore-11.3.0         (H)
 61) FLAC/1.3.4-GCCcore-11.3.0           (H)
 62) libvorbis/1.3.7-GCCcore-11.3.0      (H)
 63) libopus/1.3.1-GCCcore-11.3.0        (H)
 64) LAME/3.100-GCCcore-11.3.0           (H)
 65) libsndfile/1.1.0-GCCcore-11.3.0     (H)
 66) ICU/71.1-GCCcore-11.3.0             (H)
 67) Szip/2.1.1-GCCcore-11.3.0           (H)
 68) HDF5/1.12.2-gompi-2022a
 69) UDUNITS/2.2.28-GCCcore-11.3.0
 70) GSL/2.7-GCC-11.3.0
 71) ATK/2.38.0-GCCcore-11.3.0           (H)
 72) Gdk-Pixbuf/2.42.8-GCCcore-11.3.0    (H)
 73) HarfBuzz/4.2.1-GCCcore-11.3.0       (H)
 74) FriBidi/1.0.12-GCCcore-11.3.0       (H)
 75) Pango/1.50.7-GCCcore-11.3.0         (H)
 76) GTK2/2.24.33-GCCcore-11.3.0         (H)
 77) Ghostscript/9.56.1-GCCcore-11.3.0   (H)
 78) JasPer/2.0.33-GCCcore-11.3.0        (H)
 79) LittleCMS/2.13.1-GCCcore-11.3.0     (H)
 80) ImageMagick/7.1.0-37-GCCcore-11.3.0 (H)
 81) GLPK/5.0-GCCcore-11.3.0             (H)
 82) nodejs/16.15.1-GCCcore-11.3.0       (H)
 83) Python/3.10.4-GCCcore-11.3.0
 84) netCDF/4.9.0-gompi-2022a
 85) GEOS/3.10.3-GCC-11.3.0
 86) nlohmann_json/3.10.5-GCCcore-11.3.0 (H)
 87) PROJ/9.0.0-GCCcore-11.3.0
 88) libgeotiff/1.7.1-GCCcore-11.3.0     (H)
 89) pybind11/2.9.2-GCCcore-11.3.0       (H)
 90) SciPy-bundle/2022.05-foss-2022a
 91) libtirpc/1.3.2-GCCcore-11.3.0       (H)
 92) HDF/4.2.15-GCCcore-11.3.0           (H)
 93) GDAL/3.5.0-foss-2022a
 94) MPFR/4.1.0-GCCcore-11.3.0           (H)
 95) libgit2/1.4.3-GCCcore-11.3.0        (H)
 96) R/4.2.1-foss-2022a

  Where:
   H:  Hidden Module
   S:  Module is Sticky, requires --force to unload or purge

 


R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###### PACKAGES AND FILE DIRECTORY ######
> 
> .libPaths("/cluster/home/marionth/R")
> library(evoTS)
Warning message:
package ‘evoTS’ was built under R version 4.2.2 
> library(paleoTS)
Warning message:
package ‘paleoTS’ was built under R version 4.2.2 
> library(stats)
> library(dplyr)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> library(parallel)
> library(foreach)
> library(doParallel)
Loading required package: iterators
> library(MCSPCD)
> 
> 
> setwd("/cluster/home/marionth/Hodell")
> getwd()
[1] "/cluster/home/marionth/Hodell"
> 
> 
> 
> 
> ###### LENGTH WITH d18O PROXY ITERATIONS ######
> 
> 
> 
> 
> data1=read.table("Hodell_and_Vayavananda_1993_Fohsella_length.txt",header=T)
> data18O <- read.csv("/cluster/home/marionth/Hodell/table_d18O.csv")
> datalength18O = cbind(data1,data18O)
> data18Obis = datalength18O %>% filter(!is.na(Mean_isotopsd18O)) #enlever toutes les lignes contenant NA dans la colonne "Mean" pour data13C et datalength
> 
> sample_sized18O=data18Obis[[1]]
> length_meansd18O=data18Obis[[2]]
> length_varianced18O=data18Obis[[3]]
> time_vectord18O=data18Obis[[4]]
> d18O_means=data18Obis[[5]]
> d18O_variance=data18Obis[[6]]
> d18O_samplesize=data18Obis[[7]]
> d18O_timevector=data18Obis[[8]]
> 
> ln.lengthd18O=paleoTS::as.paleoTS(mm=length_meansd18O, vv=length_varianced18O, nn=sample_sized18O, tt=time_vectord18O) 
> ln.lengthd18O$tt=ln.lengthd18O$tt/(max(ln.lengthd18O$tt))
> datad18Oi=paleoTS::as.paleoTS(mm=d18O_means, vv=d18O_variance, nn=d18O_samplesize, tt=d18O_timevector) #create two paleoTS object
> datad18Oi$tt=datad18Oi$tt/(max(datad18Oi$tt))  #rescale du temps   
> 
> 
> multid18Oi=make.multivar.evoTS(ln.lengthd18O, datad18Oi) 
> plotevoTS.multivariate(multid18Oi, y_min=-3, y_max=3, x.label="relative time", y.label="Trait and proxy d13C means", pch=c(20,20))
> 
> 
> 
> 
> 
> #number of cores that I want to use (also defined in the batch script)
> registerDoParallel(15)
> 
> #To calculate the time needed to process each iteration
> start_time <- Sys.time()
> 
> 
> 
> 
> ## WITH ENVIRONMENTAL FACTOR AFFECTING THE OPTIMUM OF PHENOTYPIC TRAITS FOR NUMBER OF ENVIRONMENTAL VARIABLES REDUCED (2)
> A = matrix(c(1,0,1,1), nrow = 2, byrow=TRUE) #1 for parametrised and 0 for not parametrised
> R = matrix(c(1,0,0,1), nrow = 2, byrow=TRUE) #5 traits donc 25 cases dans la matrice
> 
> 
> 
> 
> 
> #Loop foreach 
> OUOUmodel.uprowd18O <- foreach(i=1:100) %dopar% { #calculation for each iteration 
+   result <- multiResultClass() #create a table to store the results
+   
+   #set and register a different seed for each loop
+   seed <- (10+i) 
+   set.seed(seed)
+   
+   result$result1 <- seed
+   result$result2 <- fit.multivariate.OU.user.defined(multid18Oi,A.user=A,R.user=R, iterations=1)
+   
+   end_time <- Sys.time(); end_time - start_time 
+   print( end_time - start_time ) 
+   result$result3 <- end_time - start_time 
+   
+   return(result)
+   
+ }
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 2.23019 hours
Time difference of 2.509935 hours
Time difference of 2.606322 hours
Time difference of 2.748161 hours
Time difference of 3.27746 hours
Time difference of 3.513207 hours
Time difference of 4.076394 hours
Time difference of 4.168845 hours
Time difference of 4.227233 hours
Time difference of 4.946228 hours
Time difference of 5.348057 hours
Time difference of 5.567137 hours
Time difference of 5.85155 hours
Time difference of 6.204033 hours
Time difference of 6.377867 hours
Time difference of 6.395648 hours
Time difference of 6.490793 hours
Time difference of 7.484948 hours
Time difference of 7.754147 hours
Time difference of 7.855924 hours
Time difference of 8.022599 hours
Time difference of 8.413271 hours
Time difference of 8.458567 hours
Time difference of 8.925912 hours
Time difference of 9.954147 hours
Time difference of 10.29694 hours
Time difference of 10.59964 hours
Time difference of 10.86497 hours
Time difference of 11.33802 hours
Time difference of 11.90624 hours
Time difference of 11.97801 hours
Time difference of 12.1578 hours
Time difference of 12.3842 hours
Time difference of 12.71786 hours
Time difference of 12.90461 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 13.48141 hours
Time difference of 14.72138 hours
Time difference of 14.86114 hours
Time difference of 15.49469 hours
Time difference of 15.5749 hours
Time difference of 15.77698 hours
Time difference of 15.95286 hours
Time difference of 16.08247 hours
Time difference of 16.111 hours
Time difference of 16.91395 hours
Time difference of 17.142 hours
Time difference of 17.14804 hours
Time difference of 17.26973 hours
Time difference of 17.57783 hours
Time difference of 18.01198 hours
Time difference of 18.85778 hours
Time difference of 19.45389 hours
Time difference of 19.9633 hours
Time difference of 20.10943 hours
Time difference of 20.236 hours
Time difference of 20.28183 hours
Time difference of 20.55305 hours
Time difference of 20.94541 hours
Time difference of 21.11149 hours
Time difference of 21.71765 hours
Time difference of 22.03429 hours
Time difference of 22.22654 hours
Time difference of 22.22685 hours
Time difference of 23.14161 hours
Time difference of 23.33846 hours
Time difference of 23.51466 hours
Time difference of 23.664 hours
Time difference of 23.8826 hours
Time difference of 23.89279 hours
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 1.026755 days
Time difference of 1.039929 days
Time difference of 1.053075 days
Time difference of 1.066496 days
Time difference of 1.075015 days
Time difference of 1.075701 days
Time difference of 1.107959 days
Time difference of 1.112949 days
Time difference of 1.115973 days
Time difference of 1.123758 days
Time difference of 1.127966 days
Time difference of 1.152741 days
Time difference of 1.169876 days
Time difference of 1.173067 days
Time difference of 1.188838 days
Time difference of 1.196509 days
Time difference of 1.202221 days
Time difference of 1.203206 days
Time difference of 1.223966 days
Time difference of 1.225358 days
Time difference of 1.245102 days
Time difference of 1.255102 days
Time difference of 1.287135 days
Time difference of 1.287564 days
Time difference of 1.29228 days
Time difference of 1.323479 days
Time difference of 1.355987 days
Time difference of 1.362357 days
Time difference of 1.37532 days
Time difference of 1.384507 days
Time difference of 1.419787 days
> 
> 
> print ("DONE")
[1] "DONE"
> end_time <- Sys.time(); end_time - start_time
Time difference of 1.419788 days
> 
> 
> #creation of AIC matrix
> AICvalues<-matrix(ncol=2,nrow=100)
> colnames(AICvalues) <- c("iteration", "AIC")
> 
> 
> #Loop to fill the AIC matrix
> for (j in 1:100) {
+   AICvalues[j,1] = j #iteration number
+   AICvalues[j,2] = OUOUmodel.uprowd18O[[j]]$result2$AIC #AIC value
+ }
> 
> 
> #Finding the best AIC
> BestAICiteration = which.min(AICvalues[,2])
> 
> #Finding the best iteration associated to the best AIC
> BESTRESULT=OUOUmodel.uprowd18O[[BestAICiteration]]
> BESTRESULT
$LE_overall
NULL

$LE_overall_exp
NULL

$LE_overall_nonexp
NULL

$LE_without_dis
NULL

$LE_without_dis_exp
NULL

$LE_without_dis_nonexp
NULL

$LE_dis
NULL

$LE_dis_exp
NULL

$LE_dis_nonexp
NULL

$LE_non_dis
NULL

$LE_non_dis_exp
NULL

$LE_non_dis_nonexp
NULL

$np_age
NULL

$tp_dis
NULL

$nsurvival
NULL

$rsurvival
NULL

$nb_dis
NULL

$nb_dis_exp
NULL

$nb_dis_nonexp
NULL

$p_dis
NULL

$a_dis
NULL

$m_exp
NULL

$p_exp
NULL

$mortality_r
NULL

$result1
[1] 32

$result2
$converge
[1] "The search algorithm stopped as it did not make progress towards the optimal solution"

$logL
[1] 274.8172

$AICc
[1] -529.8344

$ancestral.values
[1] -1.502722 -1.054112

$SE.anc
[1] NA

$optima
[1] -1.0121163 -0.7062847

$SE.optima
[1] NA

$A
          [,1]     [,2]
[1,]  1.827241 0.000000
[2,] -9.275787 7.304382

$SE.A
[1] NA

$half.life
[1] 0.37934090 0.09489471

$R
          [,1]      [,2]
[1,] 0.3525323 0.0000000
[2,] 0.0000000 0.1197232

$SE.R
[1] NA

$method
[1] "Joint"

$K
[1] 9

$n
[1] 110

$iter
[1] 1

attr(,"class")
[1] "paleoTSfit"

$result3
Time difference of 14.72138 hours

> 
> 
> 
> save.image(file='Hodell_Length_d18O_5.RData')
> 

Job 9785627 consumed 511.7 billing hours from project nn8105k.

Submitted 2023-10-24T09:29:55; waited 18.0 seconds in the queue after becoming eligible to run.

Requested wallclock time: 3.3 days
Elapsed wallclock time:   1.4 days

Task and CPU statistics:
ID             CPUs  Tasks  CPU util                Start  Elapsed  Exit status
9785627          15            0.0 %  2023-10-24T09:30:13   34.1 h  0
9785627.batch    15      1   185.0 %  2023-10-24T09:30:13   34.1 h  0

Used CPU time:   39.4 CPU days
Unused CPU time: 0.0 CPU seconds

Memory statistics, in GiB:
ID              Alloc   Usage
9785627           6.0        
9785627.batch     6.0     5.2

Job 9785627 completed at Wed Oct 25 19:36:52 CEST 2023
