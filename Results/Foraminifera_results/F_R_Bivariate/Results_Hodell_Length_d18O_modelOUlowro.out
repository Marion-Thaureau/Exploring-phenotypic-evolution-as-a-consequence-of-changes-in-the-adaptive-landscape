Starting job 9785629 on c5-29 on saga at Tue Oct 24 09:30:13 CEST 2023


Currently Loaded Modules:
  1) StdEnv                              (S)
  2) GCCcore/11.3.0
  3) zlib/1.2.12-GCCcore-11.3.0          (H)
  4) binutils/2.38-GCCcore-11.3.0        (H)
  5) GCC/11.3.0
  6) numactl/2.0.14-GCCcore-11.3.0       (H)
  7) XZ/5.2.5-GCCcore-11.3.0             (H)
  8) libxml2/2.9.13-GCCcore-11.3.0       (H)
  9) libpciaccess/0.16-GCCcore-11.3.0    (H)
 10) hwloc/2.7.1-GCCcore-11.3.0          (H)
 11) hpcx/2.14
 12) OpenMPI/4.1.4-GCC-11.3.0
 13) OpenBLAS/0.3.20-GCC-11.3.0
 14) FlexiBLAS/3.2.0-GCC-11.3.0
 15) FFTW/3.3.10-GCC-11.3.0
 16) gompi/2022a
 17) FFTW.MPI/3.3.10-gompi-2022a
 18) ScaLAPACK/2.2.0-gompi-2022a-fb
 19) foss/2022a
 20) bzip2/1.0.8-GCCcore-11.3.0          (H)
 21) expat/2.4.8-GCCcore-11.3.0          (H)
 22) libpng/1.6.37-GCCcore-11.3.0        (H)
 23) Brotli/1.0.9-GCCcore-11.3.0         (H)
 24) freetype/2.12.1-GCCcore-11.3.0      (H)
 25) ncurses/6.3-GCCcore-11.3.0          (H)
 26) util-linux/2.38-GCCcore-11.3.0      (H)
 27) fontconfig/2.14.0-GCCcore-11.3.0    (H)
 28) xorg-macros/1.19.3-GCCcore-11.3.0   (H)
 29) X11/20220504-GCCcore-11.3.0         (H)
 30) gzip/1.12-GCCcore-11.3.0            (H)
 31) lz4/1.9.3-GCCcore-11.3.0            (H)
 32) zstd/1.5.2-GCCcore-11.3.0           (H)
 33) libdrm/2.4.110-GCCcore-11.3.0       (H)
 34) libglvnd/1.4.0-GCCcore-11.3.0       (H)
 35) libunwind/1.6.2-GCCcore-11.3.0      (H)
 36) LLVM/14.0.3-GCCcore-11.3.0          (H)
 37) Mesa/22.0.3-GCCcore-11.3.0          (H)
 38) libGLU/9.0.2-GCCcore-11.3.0         (H)
 39) pixman/0.40.0-GCCcore-11.3.0        (H)
 40) libffi/3.4.2-GCCcore-11.3.0         (H)
 41) gettext/0.21-GCCcore-11.3.0         (H)
 42) PCRE/8.45-GCCcore-11.3.0            (H)
 43) GLib/2.72.1-GCCcore-11.3.0          (H)
 44) cairo/1.17.4-GCCcore-11.3.0         (H)
 45) libreadline/8.1.2-GCCcore-11.3.0    (H)
 46) Tcl/8.6.12-GCCcore-11.3.0           (H)
 47) SQLite/3.38.3-GCCcore-11.3.0        (H)
 48) PCRE2/10.40-GCCcore-11.3.0          (H)
 49) NASM/2.15.05-GCCcore-11.3.0         (H)
 50) libjpeg-turbo/2.1.3-GCCcore-11.3.0  (H)
 51) jbigkit/2.1-GCCcore-11.3.0          (H)
 52) libdeflate/1.10-GCCcore-11.3.0      (H)
 53) LibTIFF/4.3.0-GCCcore-11.3.0        (H)
 54) Java/11.0.16
 55) Tk/8.6.12-GCCcore-11.3.0            (H)
 56) OpenSSL/1.1                         (H)
 57) cURL/7.83.0-GCCcore-11.3.0          (H)
 58) GMP/6.2.1-GCCcore-11.3.0            (H)
 59) NLopt/2.7.1-GCCcore-11.3.0          (H)
 60) libogg/1.3.5-GCCcore-11.3.0         (H)
 61) FLAC/1.3.4-GCCcore-11.3.0           (H)
 62) libvorbis/1.3.7-GCCcore-11.3.0      (H)
 63) libopus/1.3.1-GCCcore-11.3.0        (H)
 64) LAME/3.100-GCCcore-11.3.0           (H)
 65) libsndfile/1.1.0-GCCcore-11.3.0     (H)
 66) ICU/71.1-GCCcore-11.3.0             (H)
 67) Szip/2.1.1-GCCcore-11.3.0           (H)
 68) HDF5/1.12.2-gompi-2022a
 69) UDUNITS/2.2.28-GCCcore-11.3.0
 70) GSL/2.7-GCC-11.3.0
 71) ATK/2.38.0-GCCcore-11.3.0           (H)
 72) Gdk-Pixbuf/2.42.8-GCCcore-11.3.0    (H)
 73) HarfBuzz/4.2.1-GCCcore-11.3.0       (H)
 74) FriBidi/1.0.12-GCCcore-11.3.0       (H)
 75) Pango/1.50.7-GCCcore-11.3.0         (H)
 76) GTK2/2.24.33-GCCcore-11.3.0         (H)
 77) Ghostscript/9.56.1-GCCcore-11.3.0   (H)
 78) JasPer/2.0.33-GCCcore-11.3.0        (H)
 79) LittleCMS/2.13.1-GCCcore-11.3.0     (H)
 80) ImageMagick/7.1.0-37-GCCcore-11.3.0 (H)
 81) GLPK/5.0-GCCcore-11.3.0             (H)
 82) nodejs/16.15.1-GCCcore-11.3.0       (H)
 83) Python/3.10.4-GCCcore-11.3.0
 84) netCDF/4.9.0-gompi-2022a
 85) GEOS/3.10.3-GCC-11.3.0
 86) nlohmann_json/3.10.5-GCCcore-11.3.0 (H)
 87) PROJ/9.0.0-GCCcore-11.3.0
 88) libgeotiff/1.7.1-GCCcore-11.3.0     (H)
 89) pybind11/2.9.2-GCCcore-11.3.0       (H)
 90) SciPy-bundle/2022.05-foss-2022a
 91) libtirpc/1.3.2-GCCcore-11.3.0       (H)
 92) HDF/4.2.15-GCCcore-11.3.0           (H)
 93) GDAL/3.5.0-foss-2022a
 94) MPFR/4.1.0-GCCcore-11.3.0           (H)
 95) libgit2/1.4.3-GCCcore-11.3.0        (H)
 96) R/4.2.1-foss-2022a

  Where:
   H:  Hidden Module
   S:  Module is Sticky, requires --force to unload or purge

 


R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###### PACKAGES AND FILE DIRECTORY ######
> 
> .libPaths("/cluster/home/marionth/R")
> library(evoTS)
Warning message:
package ‘evoTS’ was built under R version 4.2.2 
> library(paleoTS)
Warning message:
package ‘paleoTS’ was built under R version 4.2.2 
> library(stats)
> library(dplyr)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> library(parallel)
> library(foreach)
> library(doParallel)
Loading required package: iterators
> library(MCSPCD)
> 
> 
> setwd("/cluster/home/marionth/Hodell")
> getwd()
[1] "/cluster/home/marionth/Hodell"
> 
> 
> 
> 
> ###### LENGTH WITH d18O PROXY ITERATIONS ######
> 
> 
> 
> 
> data1=read.table("Hodell_and_Vayavananda_1993_Fohsella_length.txt",header=T)
> data18O <- read.csv("/cluster/home/marionth/Hodell/table_d18O.csv")
> datalength18O = cbind(data1,data18O)
> data18Obis = datalength18O %>% filter(!is.na(Mean_isotopsd18O)) #enlever toutes les lignes contenant NA dans la colonne "Mean" pour data13C et datalength
> 
> sample_sized18O=data18Obis[[1]]
> length_meansd18O=data18Obis[[2]]
> length_varianced18O=data18Obis[[3]]
> time_vectord18O=data18Obis[[4]]
> d18O_means=data18Obis[[5]]
> d18O_variance=data18Obis[[6]]
> d18O_samplesize=data18Obis[[7]]
> d18O_timevector=data18Obis[[8]]
> 
> ln.lengthd18O=paleoTS::as.paleoTS(mm=length_meansd18O, vv=length_varianced18O, nn=sample_sized18O, tt=time_vectord18O) 
> ln.lengthd18O$tt=ln.lengthd18O$tt/(max(ln.lengthd18O$tt))
> datad18Oi=paleoTS::as.paleoTS(mm=d18O_means, vv=d18O_variance, nn=d18O_samplesize, tt=d18O_timevector) #create two paleoTS object
> datad18Oi$tt=datad18Oi$tt/(max(datad18Oi$tt))  #rescale du temps   
> 
> 
> multid18Oi=make.multivar.evoTS(ln.lengthd18O, datad18Oi) 
> plotevoTS.multivariate(multid18Oi, y_min=-3, y_max=3, x.label="relative time", y.label="Trait and proxy d13C means", pch=c(20,20))
> 
> 
> 
> 
> 
> #number of cores that I want to use (also defined in the batch script)
> registerDoParallel(15)
> 
> #To calculate the time needed to process each iteration
> start_time <- Sys.time()
> 
> 
> 
> 
> ## WITH ENVIRONMENTAL FACTOR AFFECTING THE OPTIMUM OF PHENOTYPIC TRAITS FOR NUMBER OF ENVIRONMENTAL VARIABLES REDUCED (2)
> A = matrix(c(0,0,1,1), nrow = 2, byrow=TRUE) #1 for parametrised and 0 for not parametrised
> R = matrix(c(1,0,0,1), nrow = 2, byrow=TRUE) #5 traits donc 25 cases dans la matrice
> 
> 
> 
> 
> 
> #Loop foreach 
> OUOUmodel.uprowd18O <- foreach(i=1:100) %dopar% { #calculation for each iteration 
+   result <- multiResultClass() #create a table to store the results
+   
+   #set and register a different seed for each loop
+   seed <- (10+i) 
+   set.seed(seed)
+   
+   result$result1 <- seed
+   result$result2 <- fit.multivariate.OU.user.defined(multid18Oi,A.user=A,R.user=R, iterations=1)
+   
+   end_time <- Sys.time(); end_time - start_time 
+   print( end_time - start_time ) 
+   result$result3 <- end_time - start_time 
+   
+   return(result)
+   
+ }
ERROR : The initial parameters did not work. Trying a new set of candidate starting values. 
Time difference of 1.663639 hours
Time difference of 2.380722 hours
Time difference of 3.315947 hours
Time difference of 3.712 hours
Time difference of 4.10981 hours
Time difference of 4.148623 hours
Time difference of 4.283511 hours
Time difference of 4.339132 hours
Time difference of 4.456201 hours
Time difference of 4.484301 hours
Time difference of 4.528269 hours
Time difference of 4.575538 hours
Time difference of 4.972071 hours
Time difference of 5.279651 hours
Time difference of 5.697223 hours
Time difference of 6.976733 hours
Time difference of 7.213524 hours
Time difference of 7.24988 hours
Time difference of 7.631186 hours
Time difference of 8.088917 hours
Time difference of 8.187957 hours
Time difference of 8.353114 hours
Time difference of 9.031996 hours
Time difference of 9.400533 hours
Time difference of 9.496049 hours
Time difference of 9.851473 hours
Time difference of 9.968448 hours
Time difference of 10.15864 hours
Time difference of 10.20102 hours
Time difference of 10.62486 hours
Time difference of 10.74513 hours
Time difference of 10.80686 hours
Time difference of 11.52647 hours
Time difference of 11.52913 hours
Time difference of 11.53528 hours
Time difference of 11.61921 hours
Time difference of 11.99037 hours
Time difference of 12.08271 hours
Time difference of 12.92338 hours
Time difference of 12.95304 hours
Time difference of 13.16532 hours
Time difference of 13.31739 hours
Time difference of 13.56797 hours
Time difference of 14.22249 hours
Time difference of 14.28684 hours
Time difference of 14.64499 hours
Time difference of 14.74356 hours
Time difference of 15.27048 hours
Time difference of 15.68858 hours
Time difference of 15.98275 hours
Time difference of 16.25097 hours
Time difference of 16.52959 hours
Time difference of 16.84162 hours
Time difference of 16.84536 hours
Time difference of 16.94145 hours
Time difference of 17.04544 hours
Time difference of 17.39791 hours
Time difference of 17.39825 hours
Time difference of 17.64405 hours
Time difference of 18.25718 hours
Time difference of 18.49069 hours
Time difference of 18.50361 hours
Time difference of 19.30368 hours
Time difference of 19.39132 hours
Time difference of 19.735 hours
Time difference of 20.18088 hours
Time difference of 20.34253 hours
Time difference of 20.50258 hours
Time difference of 20.54476 hours
Time difference of 20.68311 hours
Time difference of 20.76742 hours
Time difference of 20.95239 hours
Time difference of 21.0799 hours
Time difference of 21.34817 hours
Time difference of 21.93853 hours
Time difference of 22.18936 hours
Time difference of 22.27808 hours
Time difference of 22.58605 hours
Time difference of 22.62841 hours
Time difference of 22.72977 hours
Time difference of 22.74502 hours
Time difference of 23.00818 hours
Time difference of 23.1588 hours
Time difference of 23.5596 hours
Time difference of 23.92123 hours
Time difference of 23.96979 hours
Time difference of 1.009185 days
Time difference of 1.026796 days
Time difference of 1.030774 days
Time difference of 1.035892 days
Time difference of 1.040213 days
Time difference of 1.05117 days
Time difference of 1.051545 days
Time difference of 1.058211 days
Time difference of 1.059965 days
Time difference of 1.103649 days
Time difference of 1.134005 days
Time difference of 1.138741 days
Time difference of 1.160193 days
Time difference of 1.168132 days
> 
> 
> print ("DONE")
[1] "DONE"
> end_time <- Sys.time(); end_time - start_time
Time difference of 1.168134 days
> 
> 
> #creation of AIC matrix
> AICvalues<-matrix(ncol=2,nrow=100)
> colnames(AICvalues) <- c("iteration", "AIC")
> 
> 
> #Loop to fill the AIC matrix
> for (j in 1:100) {
+   AICvalues[j,1] = j #iteration number
+   AICvalues[j,2] = OUOUmodel.uprowd18O[[j]]$result2$AIC #AIC value
+ }
> 
> 
> #Finding the best AIC
> BestAICiteration = which.min(AICvalues[,2])
> 
> #Finding the best iteration associated to the best AIC
> BESTRESULT=OUOUmodel.uprowd18O[[BestAICiteration]]
> BESTRESULT
$LE_overall
NULL

$LE_overall_exp
NULL

$LE_overall_nonexp
NULL

$LE_without_dis
NULL

$LE_without_dis_exp
NULL

$LE_without_dis_nonexp
NULL

$LE_dis
NULL

$LE_dis_exp
NULL

$LE_dis_nonexp
NULL

$LE_non_dis
NULL

$LE_non_dis_exp
NULL

$LE_non_dis_nonexp
NULL

$np_age
NULL

$tp_dis
NULL

$nsurvival
NULL

$rsurvival
NULL

$nb_dis
NULL

$nb_dis_exp
NULL

$nb_dis_nonexp
NULL

$p_dis
NULL

$a_dis
NULL

$m_exp
NULL

$p_exp
NULL

$mortality_r
NULL

$result1
[1] 74

$result2
$converge
[1] "Model converged successfully"

$logL
[1] 272.9407

$AICc
[1] -530.7834

$ancestral.values
[1] -1.50646 -1.09219

$SE.anc
[1] NA

$optima
[1]       NA 4.750092

$SE.optima
[1] NA

$A
          [,1]     [,2]
[1,]   0.00000  0.00000
[2,] -15.55447 19.35856

$SE.A
[1] NA

$half.life
[1]        Inf 0.03580571

$R
          [,1]      [,2]
[1,] 0.3226612 0.0000000
[2,] 0.0000000 0.3567248

$SE.R
[1] NA

$method
[1] "Joint"

$K
[1] 7

$n
[1] 110

$iter
[1] 1

attr(,"class")
[1] "paleoTSfit"

$result3
Time difference of 23.00818 hours

> 
> 
> 
> save.image(file='Hodell_Length_d18O_6.RData')
> 

Job 9785629 consumed 421.1 billing hours from project nn8105k.

Submitted 2023-10-24T09:30:04; waited 9.0 seconds in the queue after becoming eligible to run.

Requested wallclock time: 3.3 days
Elapsed wallclock time:   1.2 days

Task and CPU statistics:
ID             CPUs  Tasks  CPU util                Start  Elapsed  Exit status
9785629          15            0.0 %  2023-10-24T09:30:13   28.1 h  0
9785629.batch    15      1   179.0 %  2023-10-24T09:30:13   28.1 h  0

Used CPU time:   31.4 CPU days
Unused CPU time: 0.0 CPU seconds

Memory statistics, in GiB:
ID              Alloc   Usage
9785629           6.0        
9785629.batch     6.0     6.1

Job 9785629 completed at Wed Oct 25 13:34:30 CEST 2023
