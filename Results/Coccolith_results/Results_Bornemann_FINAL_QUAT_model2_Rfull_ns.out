Starting job 11049537 on c11-28 on saga at Fri Mar 29 15:24:54 CET 2024


Currently Loaded Modules:
  1) StdEnv                              (S)
  2) GCCcore/11.3.0
  3) zlib/1.2.12-GCCcore-11.3.0          (H)
  4) binutils/2.38-GCCcore-11.3.0        (H)
  5) GCC/11.3.0
  6) numactl/2.0.14-GCCcore-11.3.0       (H)
  7) XZ/5.2.5-GCCcore-11.3.0             (H)
  8) libxml2/2.9.13-GCCcore-11.3.0       (H)
  9) libpciaccess/0.16-GCCcore-11.3.0    (H)
 10) hwloc/2.7.1-GCCcore-11.3.0          (H)
 11) hpcx/2.14
 12) OpenMPI/4.1.4-GCC-11.3.0
 13) OpenBLAS/0.3.20-GCC-11.3.0
 14) FlexiBLAS/3.2.0-GCC-11.3.0
 15) FFTW/3.3.10-GCC-11.3.0
 16) gompi/2022a
 17) FFTW.MPI/3.3.10-gompi-2022a
 18) ScaLAPACK/2.2.0-gompi-2022a-fb
 19) foss/2022a
 20) bzip2/1.0.8-GCCcore-11.3.0          (H)
 21) expat/2.4.8-GCCcore-11.3.0          (H)
 22) libpng/1.6.37-GCCcore-11.3.0        (H)
 23) Brotli/1.0.9-GCCcore-11.3.0         (H)
 24) freetype/2.12.1-GCCcore-11.3.0      (H)
 25) ncurses/6.3-GCCcore-11.3.0          (H)
 26) util-linux/2.38-GCCcore-11.3.0      (H)
 27) fontconfig/2.14.0-GCCcore-11.3.0    (H)
 28) xorg-macros/1.19.3-GCCcore-11.3.0   (H)
 29) X11/20220504-GCCcore-11.3.0         (H)
 30) gzip/1.12-GCCcore-11.3.0            (H)
 31) lz4/1.9.3-GCCcore-11.3.0            (H)
 32) zstd/1.5.2-GCCcore-11.3.0           (H)
 33) libdrm/2.4.110-GCCcore-11.3.0       (H)
 34) libglvnd/1.4.0-GCCcore-11.3.0       (H)
 35) libunwind/1.6.2-GCCcore-11.3.0      (H)
 36) LLVM/14.0.3-GCCcore-11.3.0          (H)
 37) Mesa/22.0.3-GCCcore-11.3.0          (H)
 38) libGLU/9.0.2-GCCcore-11.3.0         (H)
 39) pixman/0.40.0-GCCcore-11.3.0        (H)
 40) libffi/3.4.2-GCCcore-11.3.0         (H)
 41) gettext/0.21-GCCcore-11.3.0         (H)
 42) PCRE/8.45-GCCcore-11.3.0            (H)
 43) GLib/2.72.1-GCCcore-11.3.0          (H)
 44) cairo/1.17.4-GCCcore-11.3.0         (H)
 45) libreadline/8.1.2-GCCcore-11.3.0    (H)
 46) Tcl/8.6.12-GCCcore-11.3.0           (H)
 47) SQLite/3.38.3-GCCcore-11.3.0        (H)
 48) PCRE2/10.40-GCCcore-11.3.0          (H)
 49) NASM/2.15.05-GCCcore-11.3.0         (H)
 50) libjpeg-turbo/2.1.3-GCCcore-11.3.0  (H)
 51) jbigkit/2.1-GCCcore-11.3.0          (H)
 52) libdeflate/1.10-GCCcore-11.3.0      (H)
 53) LibTIFF/4.3.0-GCCcore-11.3.0        (H)
 54) Java/11.0.16
 55) Tk/8.6.12-GCCcore-11.3.0            (H)
 56) OpenSSL/1.1                         (H)
 57) cURL/7.83.0-GCCcore-11.3.0          (H)
 58) GMP/6.2.1-GCCcore-11.3.0            (H)
 59) NLopt/2.7.1-GCCcore-11.3.0          (H)
 60) libogg/1.3.5-GCCcore-11.3.0         (H)
 61) FLAC/1.3.4-GCCcore-11.3.0           (H)
 62) libvorbis/1.3.7-GCCcore-11.3.0      (H)
 63) libopus/1.3.1-GCCcore-11.3.0        (H)
 64) LAME/3.100-GCCcore-11.3.0           (H)
 65) libsndfile/1.1.0-GCCcore-11.3.0     (H)
 66) ICU/71.1-GCCcore-11.3.0             (H)
 67) Szip/2.1.1-GCCcore-11.3.0           (H)
 68) HDF5/1.12.2-gompi-2022a
 69) UDUNITS/2.2.28-GCCcore-11.3.0
 70) GSL/2.7-GCC-11.3.0
 71) ATK/2.38.0-GCCcore-11.3.0           (H)
 72) Gdk-Pixbuf/2.42.8-GCCcore-11.3.0    (H)
 73) HarfBuzz/4.2.1-GCCcore-11.3.0       (H)
 74) FriBidi/1.0.12-GCCcore-11.3.0       (H)
 75) Pango/1.50.7-GCCcore-11.3.0         (H)
 76) GTK2/2.24.33-GCCcore-11.3.0         (H)
 77) Ghostscript/9.56.1-GCCcore-11.3.0   (H)
 78) JasPer/2.0.33-GCCcore-11.3.0        (H)
 79) LittleCMS/2.13.1-GCCcore-11.3.0     (H)
 80) ImageMagick/7.1.0-37-GCCcore-11.3.0 (H)
 81) GLPK/5.0-GCCcore-11.3.0             (H)
 82) nodejs/16.15.1-GCCcore-11.3.0       (H)
 83) Python/3.10.4-GCCcore-11.3.0
 84) netCDF/4.9.0-gompi-2022a
 85) GEOS/3.10.3-GCC-11.3.0
 86) nlohmann_json/3.10.5-GCCcore-11.3.0 (H)
 87) PROJ/9.0.0-GCCcore-11.3.0
 88) libgeotiff/1.7.1-GCCcore-11.3.0     (H)
 89) pybind11/2.9.2-GCCcore-11.3.0       (H)
 90) SciPy-bundle/2022.05-foss-2022a
 91) libtirpc/1.3.2-GCCcore-11.3.0       (H)
 92) HDF/4.2.15-GCCcore-11.3.0           (H)
 93) GDAL/3.5.0-foss-2022a
 94) MPFR/4.1.0-GCCcore-11.3.0           (H)
 95) libgit2/1.4.3-GCCcore-11.3.0        (H)
 96) R/4.2.1-foss-2022a

  Where:
   H:  Hidden Module
   S:  Module is Sticky, requires --force to unload or purge

 


R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ####################
> # BORNEMANN SCRIPT #
> ####################
> 
> 
> .libPaths("/cluster/home/marionth/R")
> library(usethis)
> library(evoTS)
Warning message:
package ‘evoTS’ was built under R version 4.2.2 
> library(paleoTS)
Warning message:
package ‘paleoTS’ was built under R version 4.2.2 
> library(stats)
> library(dplyr)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> library(parallel)
> library(foreach)
> library(doParallel)
Loading required package: iterators
> library(MCSPCD)
> 
> 
> setwd("/cluster/home/marionth/Bornemann")
> 
> 
> 
> 
> # LOAD MORPHOLOGICAL DATA
> ## Coccolith ellipsicity
> 
> data1 <- read.delim("/cluster/home/marionth/Bornemann/Biscutum_EllipsicitePlacolith.txt")
> summary(data1)
       N        trait_mean      trait_var            age_MY       
 Min.   :60   Min.   :1.139   Min.   :0.001706   Min.   :0.00000  
 1st Qu.:60   1st Qu.:1.170   1st Qu.:0.005848   1st Qu.:0.04016  
 Median :60   Median :1.180   Median :0.006123   Median :0.07226  
 Mean   :60   Mean   :1.182   Mean   :0.006867   Mean   :0.07506  
 3rd Qu.:60   3rd Qu.:1.191   3rd Qu.:0.006596   3rd Qu.:0.10211  
 Max.   :60   Max.   :1.221   Max.   :0.024865   Max.   :0.15900  
      ID           
 Length:50         
 Class :character  
 Mode  :character  
                   
                   
                   
> 
> sample_size=data1[[1]]
> ellipsicite_means=data1[[2]]
> ellipsicite_variance=data1[[3]]
> time_vector=data1[[4]]
> 
> ellipsicite=paleoTS::as.paleoTS(mm=ellipsicite_means, vv=ellipsicite_variance, nn=sample_size, tt=time_vector) # faire un paleoTS object
> ln.ellipsicite=paleoTS::ln.paleoTS(ellipsicite) # creer une approximative log-transformation des donnees si ce n est pas deja fait
> ln.ellipsicite$tt<-ln.ellipsicite$tt/(max(ln.ellipsicite$tt)) # transferer time vector en une unite de longueur
> 
> plotevoTS(ln.ellipsicite) # plotter l evolution du trait au cours du temps
> 
> 
> 
> ## Size of central unit
> 
> data2 <- read.delim("/cluster/home/marionth/Bornemann/Biscutum_LengthRcentralunit.txt")
> summary(data2)
       N        trait_mean      trait_var           age_MY       
 Min.   :60   Min.   :1.182   Min.   :0.03606   Min.   :0.00000  
 1st Qu.:60   1st Qu.:1.273   1st Qu.:0.05793   1st Qu.:0.03993  
 Median :60   Median :1.339   Median :0.07763   Median :0.07194  
 Mean   :60   Mean   :1.344   Mean   :0.07713   Mean   :0.07526  
 3rd Qu.:60   3rd Qu.:1.399   3rd Qu.:0.09625   3rd Qu.:0.10228  
 Max.   :60   Max.   :1.542   Max.   :0.12581   Max.   :0.15900  
      ID           
 Length:50         
 Class :character  
 Mode  :character  
                   
                   
                   
> 
> lengthcentral_means=data2[[2]]
> lengthcentral_variance=data2[[3]]
> 
> lengthcentral=paleoTS::as.paleoTS(mm=lengthcentral_means, vv=lengthcentral_variance, nn=sample_size, tt=time_vector) # faire un paleoTS object
> ln.lengthcentral=paleoTS::ln.paleoTS(lengthcentral) # creer une approximative log-transformation des donnees si ce n est pas deja fait
> ln.lengthcentral$tt<-ln.lengthcentral$tt/(max(ln.lengthcentral$tt)) # transferer time vector en une unite de longueur
> 
> plotevoTS(ln.lengthcentral) # plotter l evolution du trait au cours du temps
> 
> 
> 
> 
> ## Total length of the coccolith
> 
> data3 <- read.delim("/cluster/home/marionth/Bornemann/Biscutum_TotalcoccolithLength.txt")
> summary(data3)
       N        trait_mean      trait_var          age_MY       
 Min.   :60   Min.   :3.153   Min.   :0.2098   Min.   :0.00000  
 1st Qu.:60   1st Qu.:3.342   1st Qu.:0.3685   1st Qu.:0.03966  
 Median :60   Median :3.410   Median :0.4413   Median :0.07200  
 Mean   :60   Mean   :3.429   Mean   :0.4490   Mean   :0.07508  
 3rd Qu.:60   3rd Qu.:3.506   3rd Qu.:0.4843   3rd Qu.:0.10184  
 Max.   :60   Max.   :3.752   Max.   :1.5879   Max.   :0.15900  
      ID           
 Length:50         
 Class :character  
 Mode  :character  
                   
                   
                   
> 
> totallength_means=data3[[2]]
> totallength_variance=data3[[3]]
> 
> totallength=paleoTS::as.paleoTS(mm=totallength_means, vv=totallength_variance, nn=sample_size, tt=time_vector) # faire un paleoTS object
> ln.totallength=paleoTS::ln.paleoTS(totallength) # creer une approximative log-transformation des donnees si ce n est pas deja fait
> ln.totallength$tt<-ln.totallength$tt/(max(ln.totallength$tt)) # transferer time vector en une unite de longueur
> 
> plotevoTS(ln.totallength) # plotter l evolution du trait au cours du temps
> 
> 
> 
> 
> 
> # LOAD ENVIRONMENTAL DATA
> 
> 
> 
> 
> isotopes <- read.delim("/cluster/home/marionth/Bornemann/isotopes.txt")
> 
> geochemistrysample_size=isotopes[[1]]
> geochemistrytime_vector=isotopes[[7]]
> geochemistryvariance=isotopes[[2]]
> d13Ccarb_means=isotopes[[5]]
> d18Ocarb_means=isotopes[[6]]
> 
> 
> 
> d13Ccarb=paleoTS::as.paleoTS(mm=d13Ccarb_means, vv=geochemistryvariance+0.0001, nn=geochemistrysample_size, tt=geochemistrytime_vector, oldest="first")
> d13Ccarb$tt=d13Ccarb$tt/(max(d13Ccarb$tt))
> 
> d18Ocarb=paleoTS::as.paleoTS(mm=d18Ocarb_means, vv=geochemistryvariance+0.0001, nn=geochemistrysample_size, tt=geochemistrytime_vector, oldest="first")
> d18Ocarb$tt=d18Ocarb$tt/(max(d18Ocarb$tt))
> 
> 
> 
> 
> 
> 
> multiENVI=make.multivar.evoTS(ln.totallength, d18Ocarb, d13Ccarb) 
> plotevoTS.multivariate(multiENVI, y_min=-3, y_max=3, x.label="relative time", y.label="Trait and proxy d18O and d13C means", pch=c(20,20))
> 
> 
> 
> 
> 
> #number of cores that I want to use (also defined in the batch srcipt)
> registerDoParallel(52)
> 
> #To calculate the time needed to process each iteration
> start_time <- Sys.time()
> 
> 
> 
> ##NO COEVOLUTION
> A = matrix(c(1,1,0,0,1,0,0,0,1), nrow = 3, byrow=TRUE)
> R = matrix(c(1,1,1,1,1,1,1,1,1), nrow = 3, byrow=TRUE) 
> 
> 
> 
> 
> #Loop foreach 
> OUOU.model1 <- foreach(i=1:100) %dopar% { #calculation for each iteration 
+   result <- multiResultClass() #create a table to store the results
+   
+   #set and register a different seed for each loop
+   seed <- (10+i) 
+   set.seed(seed)
+   
+   result$result1 <- seed
+   result$result2 <- fit.multivariate.OU.user.defined(multiENVI, A.user=A,R.user=R, iterations = 1, hess = TRUE)
+   
+   end_time <- Sys.time(); end_time - start_time 
+   print( end_time - start_time ) 
+   result$result3 <- end_time - start_time 
+   
+   return(result)
+   
+ }
ERROR : $ operator is invalid for atomic vectors 
ERROR : $ operator is invalid for atomic vectors 
ERROR : $ operator is invalid for atomic vectors 
ERROR : $ operator is invalid for atomic vectors 
ERROR : $ operator is invalid for atomic vectors 
Time difference of 5.396617 hours
Time difference of 5.48916 hours
ERROR : $ operator is invalid for atomic vectors 
ERROR : $ operator is invalid for atomic vectors 
ERROR : $ operator is invalid for atomic vectors 
ERROR : $ operator is invalid for atomic vectors 
Time difference of 6.500415 hours
Time difference of 6.506435 hours
Time difference of 6.676258 hours
Time difference of 6.738036 hours
Time difference of 6.779437 hours
Time difference of 7.038255 hours
Time difference of 7.088741 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 7.51452 hours
Time difference of 7.865692 hours
Time difference of 7.867415 hours
Time difference of 7.905121 hours
Time difference of 7.933996 hours
Time difference of 8.114296 hours
Time difference of 8.618906 hours
Time difference of 8.659325 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 9.558216 hours
Time difference of 9.612651 hours
Time difference of 9.856009 hours
Time difference of 9.859913 hours
Time difference of 9.863918 hours
Time difference of 10.0636 hours
Time difference of 10.25399 hours
Time difference of 10.26341 hours
Time difference of 10.48788 hours
Time difference of 10.54324 hours
Time difference of 10.69182 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 10.85789 hours
Time difference of 11.04003 hours
Time difference of 11.38951 hours
Time difference of 11.47129 hours
Time difference of 11.55674 hours
Time difference of 11.77112 hours
Time difference of 11.9247 hours
Time difference of 11.95386 hours
Time difference of 12.16528 hours
Time difference of 12.20685 hours
Time difference of 12.28481 hours
Time difference of 12.51624 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 12.5834 hours
Time difference of 12.76416 hours
Time difference of 12.9983 hours
Time difference of 13.05978 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 13.1809 hours
Time difference of 13.21361 hours
Time difference of 13.7212 hours
Time difference of 13.74301 hours
Time difference of 13.84501 hours
Time difference of 13.91899 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 14.22997 hours
Time difference of 14.30761 hours
Time difference of 14.51741 hours
Time difference of 14.53696 hours
Time difference of 14.54193 hours
Time difference of 14.59971 hours
Time difference of 15.22012 hours
Time difference of 15.37681 hours
Time difference of 15.42582 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 15.62035 hours
Time difference of 15.78735 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 15.86996 hours
Time difference of 16.02311 hours
Time difference of 16.17953 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 16.27533 hours
Time difference of 16.40011 hours
Time difference of 16.76774 hours
Time difference of 16.85854 hours
Time difference of 16.8626 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 17.17548 hours
Time difference of 17.20186 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 17.25773 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 17.41404 hours
Time difference of 17.4835 hours
Time difference of 17.55979 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 17.58131 hours
Time difference of 17.60317 hours
Time difference of 17.61508 hours
Time difference of 17.6243 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 17.66757 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 17.7638 hours
Time difference of 17.84162 hours
Time difference of 17.84247 hours
Time difference of 17.91181 hours
Time difference of 17.9332 hours
Time difference of 17.94864 hours
ERROR : $ operator is invalid for atomic vectors 
Time difference of 18.07031 hours
Time difference of 18.24449 hours
Time difference of 18.28316 hours
Time difference of 18.29169 hours
Time difference of 18.38365 hours
Time difference of 18.54213 hours
Time difference of 18.6039 hours
Time difference of 18.8339 hours
Time difference of 18.87083 hours
Time difference of 18.9224 hours
Time difference of 19.07846 hours
Time difference of 19.51952 hours
Time difference of 19.69584 hours
Time difference of 19.80138 hours
> 
> 
> print ("DONE")
[1] "DONE"
> end_time <- Sys.time(); end_time - start_time
Time difference of 19.80139 hours
> 
> 
> 
> 
> 
> save.image(file='Bornemann_FINAL_QUAT_modelR2_ns.RData')
> 
> 
> 
> 
> 
> #creation of AIC matrix
> AICvalues<-matrix(ncol=2,nrow=100)
> colnames(AICvalues) <- c("iteration", "AIC")
> 
> 
> #Loop to fill the AIC matrix
> for (j in 1:100) {
+   AICvalues[j,1] = j #iteration number
+   AICvalues[j,2] = OUOU.model1[[j]]$result2$AIC #AIC value
+ }
> 
> 
> #Finding the best AIC
> BestAICiteration = which.min(AICvalues[,2])
> 
> #Finding the best iteration associated to the best AIC
> BESTRESULT=OUOU.model1[[BestAICiteration]]
> BESTRESULT
$LE_overall
NULL

$LE_overall_exp
NULL

$LE_overall_nonexp
NULL

$LE_without_dis
NULL

$LE_without_dis_exp
NULL

$LE_without_dis_nonexp
NULL

$LE_dis
NULL

$LE_dis_exp
NULL

$LE_dis_nonexp
NULL

$LE_non_dis
NULL

$LE_non_dis_exp
NULL

$LE_non_dis_nonexp
NULL

$np_age
NULL

$tp_dis
NULL

$nsurvival
NULL

$rsurvival
NULL

$nb_dis
NULL

$nb_dis_exp
NULL

$nb_dis_nonexp
NULL

$p_dis
NULL

$a_dis
NULL

$m_exp
NULL

$p_exp
NULL

$mortality_r
NULL

$result1
[1] 55

$result2
$converge
[1] "Model converged successfully"

$logL
[1] 103.5713

$AICc
[1] -158.6577

$ancestral.values
[1]  1.277381 -4.010969  1.588295

$SE.anc
[1] 0.025745975 0.009997321 0.009993939

$optima
[1]  1.228044 -4.056286  1.603420

$SE.optima
[1] 0.006784592 0.081358631 0.092019728

$A
         [,1]      [,2]     [,3]
[1,] 184.1454  3.597979  0.00000
[2,]   0.0000 36.706329  0.00000
[3,]   0.0000  0.000000 24.94072

$SE.A
         [,1]      [,2]     [,3]
[1,] 225.9588  7.525519 0.000000
[2,]   0.0000 12.151304 0.000000
[3,]   0.0000  0.000000 9.532138

$half.life
[1] 0.00376413 0.01888359 0.02779179

$R
           [,1]       [,2]       [,3]
[1,]  0.4140280 -0.1640376 -0.2037354
[2,] -0.1640376  8.0788789  3.5687930
[3,] -0.2037354  3.5687930  5.0179919

$SE.R
           [,1]      [,2]       [,3]
[1,] 0.23786710 0.1396602 0.05611419
[2,] 0.13966021 0.2605035 0.11896040
[3,] 0.05611419 0.1189604 0.08272330

$method
[1] "Joint"

$K
[1] 16

$n
[1] 50

$iter
[1] 1

attr(,"class")
[1] "paleoTSfit"

$result3
Time difference of 10.85789 hours

> 

Job 11049537 consumed 1030.9 billing hours from project nn8105k.

Submitted 2024-03-29T15:24:54; waited 0.0 seconds in the queue after becoming eligible to run.

Requested wallclock time: 5.0 days
Elapsed wallclock time:   19.8 hours

Task and CPU statistics:
ID              CPUs  Tasks  CPU util                Start  Elapsed  Exit status
11049537          52            0.0 %  2024-03-29T15:24:54   19.8 h  0
11049537.batch    52      1   181.8 %  2024-03-29T15:24:54   19.8 h  0

Used CPU time:   78.1 CPU days
Unused CPU time: 0.0 CPU seconds

Memory statistics, in GiB:
ID               Alloc   Usage
11049537          60.0        
11049537.batch    60.0    17.4

Job 11049537 completed at Sat Mar 30 11:14:21 CET 2024
